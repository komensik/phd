---
title: "analysis"
format: html
editor: visual
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,       # Hide code by default
  warning = FALSE,
  message = FALSE
)

# Load packages
library(dplyr)
library(tidyr)
library(readr)
library(janitor)   # for clean_names()
library(tibble)
library(stringr)
library(haven)
library(tibble)
library(gt)
library(marginaleffects)
library(mediation)
library(naniar)
library(rsq)
library(patchwork)

```

```{r}
here::here()
raw_data_cleaned <- readr::read_csv("data/cleaned/coded_data_may9.csv")

#view(raw_data_cleaned)
```

## Preliminary Analyses

| Decision                | Notes                                        |
|-------------------------|----------------------------------------------|
| which version of table? | prisonerdeserves (block aware and cleaned)   |
| NAs?                    | drop silently for plot but log               |
| scale?                  | raw 0-100 for now                            |
| compare subgroups?      | for now, overall distribution of just incppl |
| summary overlays?       | mean line, kernal density, histogram bars    |
| plot aesthetics?        | clear x-axis label                           |
| Output                  |                                              |

### 1.1. Main DV: Deservingness of Incarcerated People/Prisoners

About

-   mean: 46.13

-   median: 50

-   SD: 27.96

-   variance: 782.03

```{r, prechecks}
#check counts: 

#raw_data_cleaned %>% count(d_incppl_pris_abc)

#summary:
#summary(raw_data_cleaned$d_incppl_pris_abc)



#histogram
incarc_ppl_hist <- hist(raw_data_cleaned$d_incppl_pris_abc, breaks = 20,
     main = "Deservingness of Incarcerated People/Prisoners",
     xlab = "Deservingness (0–100)", col = "gray80", border = "white")


#mean(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

#sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

#var(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

boxplot(raw_data_cleaned$d_incppl_pris_abc)

#density plot
dv_density_data <- raw_data_cleaned %>%
  dplyr::select(d_incppl_pris_abc) %>%
  filter(!is.na(d_incppl_pris_abc))

```

### 1.2. Control: Generalized Deservingness (desor)

```{r}

# Histogram for generalized deservingness control variable
desor_core_hist <- hist(raw_data_cleaned$desor_core, breaks = 20,
     main = "'Needy' Deservingness Orientation",
     xlab = "Average Deservingness of Help-Target Groups (0–100)",
     col = "gray80", border = "white")

summary(raw_data_cleaned$desor_core)
sd(raw_data_cleaned$desor_core, na.rm = TRUE)

```

### 1.3. Generalized Deservingness (desor) x

### 1.4 Cross-Tabs of Contact Types

```{r}
library(dplyr)
library(gt)
library(stringr)

#basic
contact_crosstab <- raw_data_cleaned %>%
  summarise(
    incarc_yes = sum(incarc == 1, na.rm=TRUE),
    knowincarc_yes = sum(knowincarc == 1, na.rm=TRUE),
    vict_yes = sum(vict == 1, na.rm=TRUE)
  )


# Optional: define custom labels for key combinations
pattern_labels <- tibble::tibble(
  contact_pattern = c(
    "001001", "000000", "100000", "010000", "100100",
    "010100", "110110", "110100", "011010", "001100"
  ),
  label = c(
    "No or unsure only",
    "Skipped all Q4 items",
    "Been incarcerated only",
    "Knows someone incarcerated only",
    "Been incarcerated & victimized",
    "Knows incarcerated & victimized",
    "All four: incarcerated, knows, victim, knows victim",
    "Incarcerated, knows, victim",
    "Knows incarcerated & knows victim",
    "Victimized only"
  )
)

# Join with summary table
combo_summary_labeled <- combo_summary %>%
  left_join(pattern_labels, by = "contact_pattern") %>%
  mutate(label = ifelse(is.na(label), "Other", label))
```

#### A. All Contact Combos

pull from 2B

```{r}

```

## 2. M1: Predicting deservingness

#### 2.1 Without Controls

```{r}
m1 <- lm(d_incppl_pris_abc ~ impact, data = raw_data_cleaned)
summary(m1)

```

#### 2.2 M1 Interpretation:\*

-   Q: does any carceral contact or victimization change perceived deservingness of incarcerated people (`d_incppl_pris_abc`, 0–100 scale) compared to those without any such contact (`impact = 0`).

-   Coefficients:

    -   Intercept = 43.39

        -   The average deservingness score of incarcerated people, for respondents with no contact (`impact = 0`), is on average 43.31 out of 100 on the deservingness scale. This is higher than I might have thought.

    -   impact = 7.17

        -   People who have had contact (direct, indirect, or victimization) rate incarcerated people 7.17 points higher on the 0-100 deservingness scale — on average – than those without contact.

        -   Significance: The t-val is 5.881 and p is less than 0.001, suggesting this effect is significantly significant and the probability that it is due to chance is very low.

        -   Model fit: The R-squared is 0.0156, meaning only 1.6% of the variation in deservingness is explained by this binary variable alone.

```{r, m1plot}
library(ggplot2)
# Summarize means and confidence intervals
plot_data <- raw_data_cleaned %>%
  filter(!is.na(impact)) %>%  # <- filter out NA values
  group_by(impact) %>%
  summarize(
    mean_deserving = mean(d_incppl_pris_abc, na.rm = TRUE),
    se = sd(d_incppl_pris_abc, na.rm = TRUE) / sqrt(n()),
    .groups = "drop"
  ) %>%
  mutate(
    impact_label = ifelse(impact == 1, "Any Contact", "No Contact"),
    ci_lower = mean_deserving - 1.96 * se,
    ci_upper = mean_deserving + 1.96 * se
  )

# Plot
ggplot(plot_data, aes(x = impact_label, y = mean_deserving)) +
  geom_col(fill = "gray60") +
  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
  labs(
    x = NULL,
    y = "Mean Deservingness Rating (0–100)",
    title = "Deservingness of Incarcerated People by Contact Experience"
  ) +
  theme_minimal(base_size = 14)

```

```{r}


# Function to create plot comparing no contact vs specific contact type
create_comparison_plot_data <- function(data, contact_var, 
                                       contact_label = "Has Contact") {
  
  # Create two groups: 
  # 1. No contact at all (impact == 0)
  # 2. Has this specific type of contact (contact_var == 1)
  
  no_contact <- data %>%
    filter(impact == 0) %>%
    summarize(
      mean_deserving = mean(d_incppl_pris_abc, na.rm = TRUE),
      se = sd(d_incppl_pris_abc, na.rm = TRUE) / sqrt(n()),
      n = n(),
      .groups = "drop"
    ) %>%
    mutate(group = "No Contact")
  
  has_contact <- data %>%
    filter(!!sym(contact_var) == 1) %>%
    summarize(
      mean_deserving = mean(d_incppl_pris_abc, na.rm = TRUE),
      se = sd(d_incppl_pris_abc, na.rm = TRUE) / sqrt(n()),
      n = n(),
      .groups = "drop"
    ) %>%
    mutate(group = contact_label)
  
  # Combine the two groups
  plot_data <- bind_rows(no_contact, has_contact) %>%
    mutate(
      ci_lower = mean_deserving - 1.96 * se,
      ci_upper = mean_deserving + 1.96 * se
    )
  
  return(plot_data)
}

# Function to create the plot
create_plot <- function(plot_data, title, y_limits = c(0, 100)) {
  # Ensure the order is consistent
  plot_data$group <- factor(plot_data$group, 
                           levels = c("No Contact", 
                                    setdiff(unique(plot_data$group), "No Contact")))
  
  ggplot(plot_data, aes(x = group, y = mean_deserving)) +
    geom_col(fill = "gray60") +
    geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
    geom_text(aes(label = paste0("n=", n)), vjust = -2, size = 3) +
    labs(
      x = NULL,
      y = "Mean Deservingness Rating (0–100)",
      title = title
    ) +
    ylim(y_limits) +
    theme_minimal(base_size = 12)
}

# Create plot data for each comparison
# 1. Overall impact comparison (your original plot)
impact_data <- raw_data_cleaned %>%
  filter(!is.na(impact)) %>%
  group_by(impact) %>%
  summarize(
    mean_deserving = mean(d_incppl_pris_abc, na.rm = TRUE),
    se = sd(d_incppl_pris_abc, na.rm = TRUE) / sqrt(n()),
    n = n(),
    .groups = "drop"
  ) %>%
  mutate(
    group = ifelse(impact == 1, "Any Contact", "No Contact"),
    ci_lower = mean_deserving - 1.96 * se,
    ci_upper = mean_deserving + 1.96 * se
  )

# 2. No contact vs. has been incarcerated
incarc_data <- create_comparison_plot_data(
  raw_data_cleaned, 
  "incarc", 
  "Has Been Incarcerated"
)

# 3. No contact vs. has been victimized
vict_data <- create_comparison_plot_data(
  raw_data_cleaned, 
  "vict", 
  "Has Been Victimized"
)

# 4. No contact vs. knows someone incarcerated
knowincarc_data <- create_comparison_plot_data(
  raw_data_cleaned, 
  "knowincarc", 
  "Knows Someone Incarcerated"
)

# Calculate common y-axis limits
all_data <- list(impact_data, incarc_data, vict_data, knowincarc_data)
all_ci_upper <- unlist(lapply(all_data, function(x) x$ci_upper))
all_ci_lower <- unlist(lapply(all_data, function(x) x$ci_lower))
y_limits <- c(
  min(0, min(all_ci_lower, na.rm = TRUE) - 5),
  max(100, max(all_ci_upper, na.rm = TRUE) + 5)
)

# Create all plots
plot1 <- create_plot(impact_data, "Overall Impact", y_limits)
plot2 <- create_plot(incarc_data, "No Contact vs. Has Been Incarcerated", y_limits)
plot3 <- create_plot(vict_data, "No Contact vs. Has Been Victimized", y_limits)
plot4 <- create_plot(knowincarc_data, "No Contact vs. Knows Someone Incarcerated", y_limits)

# Display individual plots
print(plot1)
print(plot2)
print(plot3)
print(plot4)

# Combine all plots
combined_plot <- (plot1 | plot2) / (plot3 | plot4)
combined_plot <- combined_plot + 
  plot_annotation(
    title = "Deservingness Ratings: No Contact vs. Specific Contact Types",
    subtitle = "Comparing baseline (no contact) with different forms of contact"
  )
print(combined_plot)

#  Fifth plot comparing all groups with multiple contact types
# This shows people with combinations of contact types
#multi_contact_data <- raw_data_cleaned %>%
 # mutate(
  #  contact_combo = case_when(
   #   impact == 0 ~ "No Contact",
    #  incarc == 1 & vict == 1 & knowincarc == 1 ~ "All Three Types",
     # incarc == 1 & vict == 1 ~ "Incarcerated + Victimized",
      #incarc == 1 & knowincarc == 1 ~ "Incarcerated + Knows Someone",
      #vict == 1 & knowincarc == 1 ~ "Victimized + Knows Someone",
      #incarc == 1 ~ "Only Incarcerated",
      #vict == 1 ~ "Only Victimized",
      #knowincarc == 1 ~ "Only Knows Someone",
      #TRUE ~ "Other"
    #)
  #) %>%
 # filter(contact_combo != "Other") %>%
#  group_by(contact_combo) %>%
#  summarize(
#    mean_deserving = mean(d_incppl_pris_abc, na.rm = TRUE),
#    se = sd(d_incppl_pris_abc, na.rm = TRUE) / sqrt(n()),
#    n = n(),
#    .groups = "drop"
#  ) %>%
#  mutate(
#    ci_lower = mean_deserving - 1.96 * se,
#    ci_upper = mean_deserving + 1.96 * se
 # )

# Plot for multiple contact types
#multi_plot <- ggplot(multi_contact_data, 
              #       aes(x = reorder(contact_combo, mean_deserving), 
                #         y = mean_deserving)) +
#  geom_col(fill = "gray60") +
#  geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
#  geom_text(aes(label = paste0("n=", n)), hjust = -0.2, size = 3) +
#  labs(
#    x = NULL,
#    y = "Mean Deservingness Rating (0–100)",
#    title = "Deservingness by Combination of Contact Types"
#  ) +
#  ylim(y_limits) +
#  coord_flip() +
#  theme_minimal(base_size = 12)

#print(multi_plot)


```

#### 2.3 (M1c) With Controls

```{r}
m1c <- lm(d_incppl_pris_abc ~ impact +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)

m1c_incarc <- lm(d_incppl_pris_abc ~ incarc +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)

m1c_vict <- lm(d_incppl_pris_abc ~ vict +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)

m1c_knowincarc <- lm(d_incppl_pris_abc ~ knowincarc +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)


summary(m1c_inc)
summary(m1c_vict)
summary(m1c_knowinc)

summary(m1c)
```

#### 2.4 Diagnostics

**Variance inflation factors – multi-colinearity**

```{r}

library(car)
# Run VIFs on  existing model object (replace 'm1' with your model name)
print(vif(m1c))

```

--\> shows (for all groups) everything 1-2, predictors mostly independent, EXCEPT:

-   fiscal_ideology 4.4

-   social_ideology 4.7

-   --\> moderate correlation

```{r}
print(vif(m1c_incarc))
print(vif(m1c_vict))
print(vif(m1c_knowincarc))
```

**Inspect for heteroskedasticity & nonlinearity**

```{r}

plot(m1c, which = 1)

plot(m1c_incarc, which = 1)

plot(m1c_vict, which = 1)

plot(m1c_knowincarc, which = 1)
```

```{r}
# Normal Q-Q plot
plot(m1c, which = 2)

plot(m1c_incarc, which = 2)

plot(m1c_vict, which = 2)

plot(m1c_knowincarc, which = 2)

qqnorm(raw_data_cleaned$d_incppl_pris_abc)
```

The above suggests skewness is afoot.

```{r}
library(ggplot2)

ggplot(m1c, aes(x = .fitted, y = .resid)) +
  geom_point(alpha = 0.4) +
  geom_smooth(se = FALSE, color = "red") +
  labs(x = "Fitted Values", y = "Residuals",
       title = "Residuals vs Fitted (Check for Nonlinearity/Heteroskedasticity)") +
  theme_minimal()

```

```{r}
library(lmtest)
bptest(m1c)
bptest(m1c_incarc)
bptest(m1c_vict)
bptest(m1c_knowincarc)

```

BP Test suggests residuals DO NOT have constant variance – there is evidence of heteroskedasticy. Some subsets of observations have larger/smaller residual spread than others. Coefficient estimates are not biased, but **standard errors are biased.**

--\> I should use robust standard errors

#### 2.5 ROBUST SE's

```{r}

library(lmtest)
library(sandwich)

coeftest(m1c, vcov = vcovHC(m1c, type = "HC1"))

coeftest(m1c_incarc, vcov = vcovHC(m1c_incarc, type = "HC1"))

coeftest(m1c_vict, vcov = vcovHC(m1c_vict, type = "HC1"))

coeftest(m1c_knowincarc, vcov = vcovHC(m1c_knowincarc, type = "HC1"))
```

***Using standardized betas – show relative explantory strength, not total explained variance***

```{r, m1cs}

m1cs <- lm(d_incppl_pris_abc ~ impact + Republican + Democrat + fiscal_ideology +
         social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
         fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
         data = raw_data_cleaned)

# 1. Standardized coefficients
library(broom)
y_sd <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

# compute sd for each predictor (binary and continuous)
sds <- sapply(model.frame(m1cs)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs <- coef(m1cs)
# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs <- coefs * c(1, sds / y_sd)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(m1cs) |> 
  mutate(std_est = estimate * c(0, sds / y_sd)) 
```

```{r}

```

#### 2.6 Interpretation

-   N = 1,577 observations used – additional 645 deleted for missingness

-   Coefficients:

    -   Intercept = 2.97 (p = 0.63)

        -   The predicted deservingness score when all predictors are 0, [so not particularly meaningful.]{.underline} Means respondent:
            -   is independent or other
            -   has the most conservative ideology
            -   ...is not impacted
            -   is
            -   (add remaining)

    -   impact = +4.60\* (p \< 0.001)

        -   Being impacted by the CJ system (incarcerated, knows, victimized) increases the predicted deservingness rating by 4.6 points on average out of 100 (4.6%), holding all else constant.

            -   Remains statistically significant, particularly because the outcome range is 0-100

            -   supports H1

    -   Republican = -0.25 (p = 0.90)

        -   Compared to Independents/Others, Republicans rate incarcerated people just 0.39 points higher, and this is not statistically significant.

        -   **No evidence** that Republican identification alone predicts harsher or more generous deservingness scores in this model (when other factors are controlled).

        -   May reflect that **ideology and punitiveness** absorb more of the variance that would otherwise be attributed to party label.

    -   Democrat = -0.72 (p = 0.61)

        -   Compared to Independents/Others, Democrats score incarcerated people 0.72 points lower on deservingness, but this is not statistically significant.

        -   There is **no reliable difference** in prisoner deservingness between Democrats and Independents/Others once we account for ideology, contact, and other controls.

        -   Coupled with the Republican coefficient, this suggests **very weak direct effects of party ID per se**, which may be surprising given elite cues—but again, could reflect ideological and experiential absorption.

    -   fiscal_ideology = +0.13 (p = 0.88)

        -   This is the effect of being more fiscally conservative (scale reversed: higher = more conservative).

        -   Not statistically significant, and the coefficient is small.

        -   **Fiscal ideology appears unrelated** (ONCE SOCIAL IDEOLOGY INCLUDED) to how respondents rate the deservingness of incarcerated people, net of party, social ideology, punitiveness, and racial attitudes.

        -   This aligns with your expectation that deservingness is more influenced by *social/cultural* orientations than by economic/fiscal ideology.

    -   social_ideology = -2.03\* (0.017)

        -   each unit increase in social conservativism predicts a 2.03 point decrease in deservingness of incarcerated people (on a 0-100 scale)

        -   marginally significant (p\~0.014) and in the expected direction

        -   some evidence social conservativism is associated with lower perceived deservingness

        -   effect size is moderate – but this all goes into the pile of "do further testing to see which controls are meaningful

    -   PenalPunitiveness = -1.15 (p \<0.0009)

        -   participant view on whether purpose of incarceration is to punish or rehabilitate.

        -   a one unit increase in belief that incarceration is primarily about punishment is associated with a 1.15-point decrease in the perceived deservingness of incarcerated people.

        -   **substantive significance:** a full-scale shift (from 1 to 7) predicts a 6.8 point drop in deservingness on a 0-100 scale – modest but meaningful, especially in the context of other predictors.

        -   this supports the claim that punitive orientations towards the purpose of incarceration shape how people evaluate the deservingness of targets.

        -   **modeling implication**: it's not entirely endogenous to deservingness ratings, bc it comes from a distinct question about the penal telos. I think this tells us that deservingness ratings don't exclusively reflect beliefs about what prison is for.

            -   However, I'm not sure this variable captures "punitivenness." In part, it bleeds into my questions about affective reactions versus judgement.

    -   desor_core = +0.73 (p \< 0.001)

        -   Interpretation:

            -   For each one-point increase in the average deservingness rating of *help-target groups*, perceived deservingness of incarcerated people increases by 0.73

        -   [**Substantive scale:**]{.underline}

            -   ranges from 0-100, so a 10-pt increase corresponds to a 7.6 point increase in prisoner deservingness – comperable to but in opp direction of penalpun effect

        -   conceptual interpretation:

            -   **so far, strongest predictor in the model**. those who generally see "helping" groups as deserving also extend that view to incarcerated people.

            -   captures individual-level variation in generalized generosity twoard marginalized/help needing populations.

            -   inclusion seems important because it helps isolate target-specific effects, shows that prisoner deservingness is partially embedded in broader affective/moral schemas about who deserves help.

        -   Modeling implication: controlling for desor might let me argue that the effect of contact on prisoner deservingness isn't just a byproduct of being generally generous – it's targeted.

    -   penalpoint = -1.147 (SE 0.345, p \<0.001) – the more someone views as prison's purpose being punishment, rather than rehabilitation, the slightly less deserving (1.15 points lower) they see incarcerated people.

    -   fire_rare = 0.39734 (p = 0.60)

        -   agreement that racial problems are rare and isolated, so more rejection of racial minimization (racial empathy) predicts lightly higher deservingness perceptions of incarcerated people.

        -   takeaway – not statistically significant, so can't rule out the possibility the relationship is due to chance. But direction aligns with theory.

    -   fire_privilege = 0.05353 (p = 0.94)

        -   Meaning: Agreement that white people benefit from unearned racial advantages

        -   Interpretation: The near-zero, nonsignificant coefficient indicates this belief does not meaningfully predict differences in perceived deservingness of incarcerated people in this model.

        -   Note: This item may be less emotionally activated than the others or more subject to social desirability bias, dampening its predictive power

    -   fire_angry = 1.18110 (p = 0.16)

        -   Meaning: Agreement with *“I am angry that racism exists.”*

        -   Interpretation: The positive direction suggests that respondents who are more emotionally angry about racism tend to see incarcerated people as more deserving, consistent with frameworks linking racial empathy to support for equity-enhancing policies.

            -   Note: While not significant, this coefficient is substantively large and may become more stable with a larger sample or better scaling.

    -   fire_fear (0.30112) (P = 0.73)

        -   Meaning: Agreement with *“I am fearful of people of other races.”*

        -   Interpretation: Respondents who express more racial fear are (slightly) more likely to rate incarcerated people as less deserving, though the effect is small and nonsignificant

        -   This aligns with theories linking racial threat or fear to punitive or exclusionary attitudes.

    -   gender = -1.02 (p=0.38 )

        -   men estimated to rate incarcerated people as slightly less deserving, but difference is small and not significant

    -   Black = rate incarcerated people as slightly lower (3.3) than do white respondents, modest but significant group-level difference (0.045)

    -   Hispanic = -3.25 (p= 0.057)

        -   rate incarcerated people 3 points less deserving than non-hispanic whites, holding all else constant

    -   OtherRace = dropped

Residual SE: 22.6 –\> moderate dispersion, consistent with attitude data

R squared: explains 34% of the variance in deservingness

F = 54.1, p \< 0.001 –\> overal model highly significant.

SUMMARY:

Individuals with personal or proximate contact with the carceral system perceive incarcerated people as significantly more deserving of help or compassion (β = 4.60, p \< 0.001). This relationship remains robust after adjusting for partisanship, ideology, punitiveness, racial attitudes, and demographics. In contrast, more socially conservative and punitive respondents evaluate incarcerated people as substantially less deserving. General deservingness orientations exert the largest effect, suggesting that judgments about incarcerated people reflect broader moral schemas about who merits social support. Race and gender do not systematically differentiate deservingness perceptions, although Hispanic respondents express somewhat lower ratings than White respondents.

BEFORE MOVING ONTO INTERPRETATION

### 2.7 With Weights

```{r}
# weights don't exist yet -- would be on 

# m1_w <- lm(prisonerdeserves ~ impact, data = raw_data_cleaned, weights = weight_var)
# summary(m1_w)
```

### 2.8 Variable Check -

Confounder, mediator, collider?

-   missingness patterns

-   variable types

-   distributions

-   outliers

Univariate explanatory power / how much does each control explain on its own?

```{r}

controls <- c("impact", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")

results <- data.frame() 

for (v in controls) {
  f <- as.formula(paste("d_incppl_pris_abc ~", v))
  fm <- lm(f, data = raw_data_cleaned)
  results <- rbind(results, 
                   data.frame(var = v, 
                              adjR2 = summary(fm)$adj.r.squared, 
                              AIC = AIC(fm)))
}

results <- results[order(-results$adjR2), ]
print(results)

#NEXT -- testing when adding controls in to m1 sequentially


for(v in controls[-1])
{
  f <- as.formula(paste("d_incppl_pris_abc ~ impact +", v))
  fm <- lm(f, data = raw_data_cleaned)
  cat(v, "adjR2 =", summary(fm)$adj.r.squared-summary(m1)$adj.r.squared, "\n")
}

#AIC - mirrors fit mostly, suggests to check counts for vars

for (v in controls) {
  f <- as.formula(paste("d_incppl_pris_abc ~", v))
  fm <- lm(f, data = raw_data_cleaned)
  cat(v, "N =", nobs(fm), "\n")
```

Find from adjusted R2 (explaining spread) that:

-   desor_core explains 30% of the variation in deservingness scores.

-   ideology measures explain 7-8%

-   FIRE variables explain 3-6%

-   PID 3-4%

-   impact explains very little – 1.5%

**Penal Point Variable – Keeping This Here because this Var Keeps on tripping you out – the correlation is -1 so it is in fact reverse coded! You will keep doubting this! Nov 2.**

```{r, echo=FALSE}
}
#unedited data
d <- read_csv("./data/raw/scotg_results.csv")

table(raw_data_cleaned$q62_1, raw_data_cleaned$penalpoint, useNA = "ifany")

library(ggplot2)

# Convert to a data frame for ggplot
tab_df <- as.data.frame(table(
  Original = raw_data_cleaned$q62_1,
  Reversed = raw_data_cleaned$penalpoint
))

ggplot(tab_df, aes(x = Original, y = Reversed, fill = Freq)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "white", high = "steelblue") +
  theme_minimal() +
  labs(title = "Cross-tab of Original vs. Reversed Values",
       fill = "Count")


mean(raw_data_cleaned$q62_1, na.rm = TRUE)
mean(raw_data_cleaned$penalpoint, na.rm = TRUE)

cor(raw_data_cleaned$q62_1, raw_data_cleaned$penalpoint, use = "pairwise.complete.obs")

par(mfrow = c(1,2))
hist(raw_data_cleaned$q62_1, main="Original")
hist(raw_data_cleaned$penalpoint, main="Reversed")

par(mfrow = c(1,2))
hist(raw_data_cleaned$q62_1, main="Original (Q62_1)")
hist(8 - raw_data_cleaned$q62_1, main="What a Reverse Looks Like")


```

**Prisonhelp and Prisonpen were more problematic after verification. The takeaway (Nov 2) is:**

-   Both prisonhelp and prisonpen now have "don't know" as Prisonhelp is constucted with both 1-5 (5 originally don't know) and 1-3.

Support for punitive and help-oriented criminal justice policies were measured using items from the Q25 and Q23 survey batteries. Each item was originally presented on a four-point Likert scale ranging from *Strongly favor (1)* to *Strongly oppose (4)*, with an additional *Don’t know / No opinion (5)* option. Consistent with conventions in survey research on ambivalence and policy preferences (e.g., Ansolabehere, Rodden, & Snyder 2008; Bartels 2016), “Don’t know” responses were recoded to the midpoint (2.5) to represent a neutral position rather than treated as missing. This approach preserves respondents with low political engagement or weak opinions and aligns the indices with other continuous measures that center on a neutral midpoint (e.g., 0–100 deservingness scales).

The **punitive policy index** (`prisonpen`) averages responses to support for the *death penalty* and *life without parole* (Q25_1, Q25_5). Higher values indicate greater opposition to punitive policy (i.e., a less punitive orientation).

The **help-oriented policy index** (`prisonhelp`) averages six items: four prison policy questions (Q25_2, Q25_3, Q25_4, Q25_6) and two election-related questions (Q23_2, Q23_7) concerning voting rights for currently or formerly incarcerated people. All items were reverse-coded so that higher values reflect stronger support for help-oriented or rehabilitative policies.

Both indices range from 1 (strongly oppose) to 4 (strongly favor), with 2.5 representing a neutral midpoint. Each index thus provides a continuous measure of policy support, facilitating direct comparison across respondents and between punitive and rehabilitative domains.

## 3. M2: by Impact

### 3.1 Incarcerated

```{r, minc}

minc <- lm(d_incppl_pris_abc ~ incarc +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)

summary(minc)

```

#### 3.1a Robust SEs

```{r}
coef_table_incarc <- coeftest(minc, vcov = vcovHC(minc, type = "HC1", cluster = NULL)) %>% broom::tidy()
```

#### 3.1b. Standardized betas

```{r}

minc_s <- lm(d_incppl_pris_abc ~ incarc + Republican + Democrat + fiscal_ideology +
         social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
         fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
         data = raw_data_cleaned)

# 1. Standardized coefficients

inc_sd <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

# compute sd for each predictor (binary and continuous)
inc_sds <- sapply(model.frame(minc_s)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs <- coef(minc_s)

# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
inc_std_coefs <- coefs * c(NA, inc_sds / inc_sd)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(minc_s) |> 
  mutate(std_est = estimate * c(NA, inc_sds / inc_sd)) 

table_std_incarc <- tidy(minc_s) |> mutate(std_est = estimate * c(NA, inc_sds / inc_sd))
```

#### 3.1c Control Variable Check

```{r}

controls_inc <- c("incarc", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
  
results_inc <- data.frame() #to reset

for (v_inc in controls_inc) {
  f_inc <- as.formula(paste("d_incppl_pris_abc ~", v_inc))
  fm_inc <- lm(f_inc, data = raw_data_cleaned)
  results_inc <- rbind(results_inc, 
                   data.frame(var = v_inc, 
                              adjR2 = summary(fm_inc)$adj.r.squared, 
                              AIC = AIC(fm_inc)))
}

results_inc <- results_inc[order(-results_inc$adjR2), ]
print(results_inc)

#NEXT -- testing when adding controls in to minc sequentially

#first make no control model version
minc_base <- lm(d_incppl_pris_abc ~ incarc, data = raw_data_cleaned)

minc_incr2 <- for(v_inc in controls_inc[-1])
{
  f_inc <- as.formula(paste("d_incppl_pris_abc ~ incarc +", v_inc))
  fm_inc <- lm(f_inc, data = raw_data_cleaned)
  cat(v_inc, "adjR2 =", summary(fm_inc)$adj.r.squared-summary(minc_base)$adj.r.squared, "\n")
}

#semi-partial R2 for each model predictor (how much unique variance each predictor explains in the full model, controlling for all other variables)

sp_r2 <- rsq.partial(minc, type = "sp")
sp_r2

#in table
sp_table_inc <- data.frame(
  variable = sp_r2$variable,
  semi_partial_R2 = sp_r2$partial.rsq
)

# largest to smallest
sp_table_inc <- sp_table %>%
  arrange(desc(semi_partial_R2))

# round for display
sp_table_inc$semi_partial_R2 <- round(sp_table_inc$semi_partial_R2, 4)

print(sp_table)

```

Interpretation (Control Variable Check)

Find from adjusted R2 (explaining spread) that:

-   desor_core explains 30% of the variation in deservingness scores.

-   ideology measures explain 7-8%

-   FIRE variables explain 3-6%

-   PID 3-4%

-   incarceration explains very little – 0.008%

AIC - mirrors fit mostly, suggests to check counts for vars

```{r}
for (v in controls_inc) {
  f <- as.formula(paste("d_incppl_pris_abc ~", v))
  fm <- lm(f, data = raw_data_cleaned)
  cat(v, "N =", nobs(fm), "\n")
}
```

### 3.2 Victimized

```{r, mv}

#10-31 AGAIN checking that I know what I'm talking about re: counts -- YES VICT, 277

mv <- lm(d_incppl_pris_abc ~ vict +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)
summary(mv)
```

#### 3.2a Robust SEs

```{r}
coef_table_vict <- coeftest(mv, vcov = vcovHC(mv, type = "HC1"))%>% broom::tidy()
```

#### 3.2b Standardized Betas

```{r}

mvs <- lm(d_incppl_pris_abc ~ vict + Republican + Democrat + fiscal_ideology +
         social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
         fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
         data = raw_data_cleaned)

# 1. Standardized coefficients
library(broom)
y_sd_v <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

# compute sd for each predictor (binary and continuous)
sds_v <- sapply(model.frame(mvs)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs_v <- coef(mvs)

# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs_v <- coefs_v * c(NA, sds_v / y_sd_v)   

# better to use broom::tidy:
tidy(mvs) |> 
  mutate(std_est_v = estimate * c(NA, sds_v / y_sd_v)) 

table_std_vict   <- tidy(mvs)    |> mutate(std_est_v = estimate * c(NA, sds_v / y_sd_v))
```

#### 3.2c Control Variable Check

Univariate explanatory power / how much does each control explain on its own?

```{r}

controls_vict <- c("vict", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")

results_vict <- data.frame()

for (v_vict in controls_vict) {
  f_vict <- as.formula(paste("d_incppl_pris_abc ~", v_vict))
  fm_vict <- lm(f_vict, data = raw_data_cleaned)
  results_vict <- rbind(results_vict, 
                   data.frame(var = v_vict, 
                              adjR2 = summary(fm_vict)$adj.r.squared, 
                              AIC = AIC(fm_vict)))
}

results_vict <- results_vict[order(-results_vict$adjR2), ]

print(results_vict)

#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mv_base <- lm(d_incppl_pris_abc ~ vict, data=raw_data_cleaned)

mvict_incr2 <-for(v_v in controls_vict[-1])
{
  f_v <- as.formula(paste("d_incppl_pris_abc ~ vict +", v_v))
  fm_v <- lm(f_v, data = raw_data_cleaned)
  cat(v_v, "adjR2 =", summary(fm_v)$adj.r.squared-summary(mv_base)$adj.r.squared, "\n")
}


#semi-partial R2 for each model predictor (how much unique variance each predictor explains in the full model, controlling for all other variables)

sp_r2_v <- rsq.partial(mv, type = "sp")
sp_r2_v

#in table
sp_table_v <- data.frame(
  variable_v = sp_r2_v$variable,
  semi_partial_R2_v = sp_r2_v$partial.rsq
)

# largest to smallest
sp_table_v <- sp_table_v %>%
  arrange(desc(semi_partial_R2_v))

# round for display
sp_table_v$semi_partial_R2_v <- round(sp_table_v$semi_partial_R2_v, 4)

print(sp_table_v)


```

### 3.3 Proximate

```{r}

mki <- lm(d_incppl_pris_abc ~ knowincarc +
    Republican + Democrat +
    fiscal_ideology + social_ideology +
    penalpoint + desor_core +
    fire_rare + fire_privilege + fire_angry + fire_fear +
    gender + Black + Hispanic + OtherRace,
  data = raw_data_cleaned
)
summary(mki)
```

#### 3.3a Robust SEs

```{r}
coef_table_prox <- coeftest(mki, vcov = vcovHC(mki, type = "HC1"))%>% broom::tidy()
```

#### 3.3b Standardized Betas

```{r}
mkis <- lm(d_incppl_pris_abc ~ knowincarc + Republican + Democrat + fiscal_ideology +
         social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
         fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
         data = raw_data_cleaned)

# 1. Standardized coefficients
library(broom)
y_sd_prox <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)

# compute sd for each predictor (binary and continuous)
sds_prox <- sapply(model.frame(mkis)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs_prox <- coef(mkis)
# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs_prox <- coefs_prox * c(NA, sds_prox / y_sd_prox)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(mkis) |> 
  mutate(std_est_prox = estimate * c(NA, sds_prox / y_sd_prox))

table_std_prox   <- tidy(mkis)   |> mutate(std_est_prox = estimate * c(NA, sds_prox / y_sd_prox))
```

#### 3.3c Control Variable Check

Univariate explanatory power / how much does each control explain on its own?

```{r}

controls_prox <- c("knowincarc","Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")

results_prox <- data.frame()

for (v_prox in controls_prox) {
  f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
  fm_prox <- lm(f_prox, data = raw_data_cleaned)
  results_prox <- rbind(results_prox, 
                   data.frame(var = v_prox, 
                              adjR2 = summary(fm_prox)$adj.r.squared, 
                              AIC = AIC(fm_prox)))
}

results_prox <- results_prox[order(-results_prox$adjR2), ]

print(results_prox)

#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mki_base <- lm(d_incppl_pris_abc ~ knowincarc, data=raw_data_cleaned)

mprox_incr2<-for(v_prox in controls_prox[-1])
{
  f_prox <- as.formula(paste("d_incppl_pris_abc ~ knowincarc +", v_prox))
  fm_prox <- lm(f_prox, data = raw_data_cleaned)
  cat(v_prox, "adjR2 =", summary(fm_prox)$adj.r.squared-summary(mki_base)$adj.r.squared, "\n")
}


#semi-partial R2 for each model predictor (how much unique variance each predictor explains in the full model, controlling for all other variables)

sp_r2_prox <- rsq.partial(mki, type = "sp")
sp_r2_prox

#in table
sp_table_prox <- data.frame(
  variable_prox = sp_r2_prox$variable,
  semi_partial_R2_prox = sp_r2_prox$partial.rsq
)

# largest to smallest
sp_table_prox <- sp_table_prox %>%
  arrange(desc(semi_partial_R2_prox))

# round for display
sp_table_prox$semi_partial_R2_prox <- round(sp_table_prox$semi_partial_R2_prox, 4)

print(sp_table_prox)


```

### M2 Tables: Impact

```{r}

key_vars <- c("d_incppl_pris_abc","incarc","knowincarc","vict","desor_core",
              "fiscal_ideology","social_ideology","penalpoint",
              "Republican","Democrat","fire_rare","fire_privilege",
              "fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")

summary_table <- raw_data_cleaned %>%
  dplyr::select(all_of(key_vars)) %>%
  skimr::skim()


#count N in each
# M2 - Incarcerated variable Ns
ncheck_inc <- sapply(controls_inc, function(v) 
  nobs(lm(as.formula(paste("d_incppl_pris_abc ~", v)), data = raw_data_cleaned))
) |> 
  tibble::enframe(name = "variable", value = "N")

# M2 - Victimized variable Ns
ncheck_vict <- sapply(controls_vict, function(v)
  nobs(lm(as.formula(paste("d_incppl_pris_abc ~", v)), data = raw_data_cleaned))
) |>
  tibble::enframe(name = "variable", value = "N")

# M2 - Proximate variable Ns
ncheck_prox <- sapply(controls_prox, function(v)
  nobs(lm(as.formula(paste("d_incppl_pris_abc ~", v)), data = raw_data_cleaned))
) |>
  tibble::enframe(name = "variable", value = "N")




#model comparison
contact_model_summary <- bind_rows(
  table_std_incarc %>% dplyr::select(term, std_est) %>% mutate(model = "Incarcerated"),
  table_std_vict   %>% dplyr::select(term, std_est_v) %>% mutate(model = "Victimized"),
  table_std_prox   %>% dplyr::select(term, std_est_prox) %>% mutate(model = "Proximate")
)


save(
  #summary
  summary_table, dv_density_data, contact_crosstab, incarc_ppl_hist,
  desor_core_hist,
  #model coefs
     coef_table_incarc, coef_table_vict, coef_table_prox,
  #semi-partial r2
     sp_table_inc, sp_table_v, sp_table_prox,
  #standardized betas
     table_std_incarc, table_std_vict, table_std_prox, 
  #univar and incremental fit diagnostics
  results_inc,results_vict,results_prox,
  minc_incr2,mvict_incr2, mprox_incr2,
  #N for each
  ncheck_inc, ncheck_vict, ncheck_prox,
  #model comparison table
  contact_model_summary, 
     file = "data/analysis_objects.RData")

summary_table
dv_density_data
contact_crosstab
incarc_ppl_hist
desor_core_hist
  #model coefs
  coef_table_incarc
coef_table_vict
coef_table_prox
  sp_table_inc
  sp_table_v
  sp_table_prox
  #standardized betas
    table_std_incarc
    table_std_vict
    table_std_prox
  #univar and incremental fit diagnostics
  results_inc
  results_vict
  results_prox
  minc_incr2
  mvict_incr2
  mprox_incr2
  #N for each
  ncheck_inc
  ncheck_vict
  ncheck_prox
  #model comparison table
  contact_model_summary

```

## 4. M3 & M4 - Deservingness on Carceral Policy

My second core hypothesis (**H2)**:

more generous perceptions of carceral citizens' deservingness will predict greater and more consistent support for assistance-oriented criminal legal policies and reduced support for punitive criminal legal policies.

To test this, I estimate outcome models for two constructed policy indices: prisonhelp and prisonpen. In each model, I include carceral contact (impact) and deservingness (prisonerdeserves) as key independent variables, along with the same controls used in M1.

In each model, $delta_1$ captures the association between carceral contact and policy preferences, controlling for deservingness and covariates. $delta_2$ estimates the relationship between deservingness and policy support, which directly tests H2. A positive and statistically significant $delta_2$ in the help model—and a negative $delta_2$ in the punitive model—would support the hypothesis that warmer evaluations of incarcerated people correspond to greater support for decarceral policies.

### M3 Deservingness on Help Policy

$$
\texttt{prisonhelp}_{i} = \delta_0 + \delta_1 \cdot \texttt{impact}_{i} + \delta_2 \cdot \texttt{prisonerdeserves}_{i} + X^{\prime}_{i} \cdot \texttt{controlsvector} + \epsilon_{i}
$$

ie: the more someone views incarcerated people as deserving:

-   the more they will support assistance-orientated CJ policy

-   the more they will oppose punitive policy

Variables needed:

-   Mediator: deservingness scores: d_incppl_pris_abc

-   any CJ contact vs no CJ contact

    -   impact

-   types of contact vs no contact

    -   knowincarc

    -   vict

    -   incarc

-   outcome indices:

    -   prisonhelp

        -   continuous 1-4 index with 2.5 as neutral midpoint. 4 = STRONGLY SUPPORT help oriented prison policy

    -   prisonpen: continuous 1-4 index with 2.5 as neutral midpoint. 4 = STRONGLY OPPOSE punitive prison policy (lwop and death penalty)

-   controls vector

```{r, controls vector}
var(raw_data_cleaned$prisonhelp, na.rm=TRUE)

names(raw_data_cleaned)

m3_0 <- lm(prisonhelp ~ Republican + Democrat , data = raw_data_cleaned)

summary(m3_0)

```

**Outcome variable: prisonhelp**

Average respondent support for policy items (1-5, 5 is strongly support):

-   requiring prison laborers to be paid minimum wage

-   eliminating prison phone call costs

-   increasing funding for GED/college in prisons

-   alternative-to-prison sentencing for convicted parents

-   restoring voting rights post-sentence (OG 1-3)

-   for bureaucratic requirements enabling voting access while incarcerated (OG 1-3)

Basic Stats:

-   variance = 0.488

### 4.\_ Preliminary **Variable check**

First, checking how respondents who identify as Republican vs Democrat differ on average support for help policies (Republican and Democrat are both dummy variables, with Independent/Other as the reference group). Confirmed that Democrats are more supportive of help policies than Republicans on average.

```{r}
prisonhelp_by_party <- lm(prisonhelp ~ Republican + Democrat, data = raw_data_cleaned)
prisonpen_by_party <- lm(prisonpen ~ Republican + Democrat, data = raw_data_cleaned)

summary(prisonhelp_by_party)
summary(prisonpen_by_party)
```

Second, looking at (a) beliefs in purpose of prison (penalpoint, 1 means you think prison is for rehabilitation 7 for punishment), (b) FIRE variables.

```{r}
prisonhelp_by_penalpoint <- lm(prisonhelp ~ penalpoint, data = raw_data_cleaned)
prisonpen_by_penalpoitn <- lm(prisonpen ~ penalpoint, data = raw_data_cleaned)

prison_help_by_fire_rare <- lm(prisonhelp ~ fire_rare, data = raw_data_cleaned)
prison_pen_by_fire_rare <- lm(prisonpen ~ fire_rare, data = raw_data_cleaned)

prison_help_by_fire_privilege <- lm(prisonhelp ~ fire_privilege, data = raw_data_cleaned)
prison_pen_by_fire_privilege <- lm(prisonpen ~ fire_privilege, data = raw_data_cleaned)

prison_help_by_fire_angry <- lm(prisonhelp ~ fire_angry, data = raw_data_cleaned)
prison_pen_by_fire_angry <- lm(prisonpen ~ fire_angry, data = raw_data_cleaned)

prison_help_by_fire_fear <- lm(prisonhelp ~fire_fear, data = raw_data_cleaned)
prison_pen_by_fire_fear <- lm(prisonpen ~fire_fear, data = raw_data_cleaned)

prison_help_by_fire_rare
prison_pen_by_fire_rare

prison_help_by_fire_privilege
prison_pen_by_fire_privilege

prison_help_by_fire_angry
prison_pen_by_fire_angry

prison_help_by_fire_fear
prison_pen_by_fire_fear

prisonhelp_by_penalpoint
prisonpen_by_penalpoitn
```

Penalpoint – unit increase (see prison as more for punishment) leads to 0.06 decrease in opposition to punitive policy; unit increase (sees prison as more for punishment) leads to unit decrease in support for help policy.

FIRE_Rare – unit increase in disagreement that racial problems are rare (ie, agreement that they are not rare) has 0.25 increase in opposition to punitive policy; a unit increase...ie agreement that racial problems are not rare corresponds to 0.132 increase in support for help policy.

FIRE Privilege - disagreement with white privilege decreases support for prison help policies; decreases opposition to punitive policies.

FIRE Angry - disagreement with anger that racism exists decreases support for prison help policy; decreases opposition to punitive policies.

FIRE Fear – disagreement with being afraid of other raises increases support for prison help policy; slightly increases opposition to punitive prison policies.

### 4.\_ Preliminary M3 & M4 Models with Controls

```{r}
#character vector of controls vector for m3 m4
 m3m4controls <- c("d_incppl_pris_abc",
  "impact","Republican", "Democrat", "fiscal_ideology", "social_ideology",
  "penalpoint", "desor_core", "fire_rare", "fire_privilege", "fire_angry",
  "fire_fear", "gender", "Black", "Hispanic", "OtherRace"
)

#M3 M4 DVs
m3dv <- "prisonhelp"

m4dv <- "prisonpen"

#Formulas where paste constructs a formula string of controls and turns it into an actual formula object
m3_controls_formula <- as.formula(
  paste(m3dv, "~", paste(m3m4controls, collapse = " + "))
)

m4_controls_formula <- as.formula(
  paste(m4dv, "~", paste(m3m4controls, collapse = " + "))
)

#M3 M4 OLS Models
m3_basic <- lm(m3_controls_formula, data = raw_data_cleaned)
m4_basic <- lm(m4_controls_formula, data = raw_data_cleaned)
```

### 4.\_ Interpretation (Preliminary M3 & M4 Models with Controls)

#### M3 Basic Model Interpretation

```{r}
summary(m3_basic)
```

The intercept indicates that, holding all controls at 0, the average support for help policies is 2.8 (on a 1-5 scale). This is not super substantive because many predictors are scaled starting at 1.

Coefficients:

-   having one unit warmer deservingness perceptions of incarcerated people increases support for help policies by 0.004 points, holding all else constant. So a 10-point increase in deservingness corresponds to a 0.04 point increase in help policy support. This is statistically significant (p\<0.001) but substantively small.

-   being impacted in some way increases support for help policies by 0.16 points, holding all else constant. This effect is significant.

-   seems funny: being republican instead of independent increases support for help policies. and being a democrat instead of independent decreases support (by 0.12 points for democrats and 0.0005 points for republicans). These effects are not significant.

-   fiscal ideology is insignificant.

-   social ideology: a unit increase in social policy support decreases support for prison help policies, and the effect is significant.

-   penalpoint: each one unit increase (1-7 scale, sees the purpose of prison more about punishment) decreases support for prison help policies decreases support for help policies by 0.05 points, holding all else constant. This is significant (p\<0.001)

-   on desor_core: each one unit increase (0-100 scale, more general orientation to see help-needing groups as deserving) decreases support for help policies by 0.003 points, holding all else constant. This is significant.

-   All of the FIRE (1-4) questions are statistically significant:

    -   a unit increase in *disagreement* that racial problems are rare corresponds with a 0.04 increase in support for help-oriented policy

    -   a unit increase in *disagreement* that white people have advantages because of their race corresponds with a 0.07 unit decrease in support for help policy.

    -   a unit increase in disagreement that 'I am angry that racism exists' corresponds with a 0.069 decrese in support for help policy

    -   a unit increase in disagreement with "I am fearful of people of other races" (ie, respondent is not fearful of other racs) corresponds with an increase in support for prison help policies by 0.075.

Fit Statistics -- the model explains about 37% of variance in help policy support (R2 is 0.3737, adjusted R2 is 0.3373) after adjusting for the number of predictors.

The F-stat and p-val confirm that, collectively, the predictors explain more variance than an intercept only model.

```{r}
summary(m4_basic)
```

### 4.\_\_ Diagnostic checks

Variance Inflation/multico. with vif --rule: 1 = no colinearity, less than 5 is sometimes concerning, sometimes stricter threshold is 2.5 - for m3_basic

-for m4_basic Neither model shows concerning multicollinearity according to VIFs. However, fiscal and social ideology are almost 5 for both models.

```{r}

vif(m3_basic)

vif(m4_basic)

```

Influence / leverage check

```{r}
plot(m3_basic, which=4) # cook's distance
plot(m4_basic, which=4) # cook's distance
```

Pairwise correlations and partial check (suppression?)

```{r}
# Focus on the key attitudinal predictors
vars_to_check <- c("desor_core", "d_incppl_pris_abc", "penalpoint", "social_ideology", "fiscal_ideology")

# Pairwise correlations
cor_mat <- raw_data_cleaned %>%
  dplyr::select(all_of(vars_to_check)) %>%
  cor(use = "pairwise.complete.obs")

print(round(cor_mat, 3))

car::avPlots(m3_basic, terms = ~ desor_core + d_incppl_pris_abc + penalpoint + social_ideology)

car::avPlots(m4_basic, terms = ~ desor_core + d_incppl_pris_abc + penalpoint + social_ideology)


```

Pairwise interpretation:

| Relationship | Interpretation |   |
|----|----|----|
| desor_core & inc ppl | strong shared variance, likely suppression |  |
| desorcore & ideo -0.37 | expected liberal/conservative |  |
| desorcore & penalpoint: -0.19 | mild relationship |  |
| fiscal & social ideology | redundant, reason to combine or drop fiscal? |  |

**Takeaway on desorcore negative coefficient:** once I partial out the incarcerated-specific deservingness, `desor_core`’s remaining variance is probably identifying respondents who are generally generous but not especially supportive of carceral “help” (e.g., people who prioritize social welfare but are skeptical when it comes to prison).

Confirmed above with regressing on residual gets 0.07, a small positive correlation (r\~0..07) between the residualized desor_core (removed its overlap with incarcerated ppl deservingness) and prisonhelp. Suggests there is probably a stronger correlation in the bivariate relationship that collapses after residualizing which suggests all (or nearly) the positive relationship between this orientation towards help-needing groups and help-oriented prison policy is shared with deservingness of incarcerated people.

```{r}

# Get residuals within a complete-data framedesor_core on the highly correlated predictor (d_incppl_pris_abc)
tmp <- raw_data_cleaned %>%
  dplyr::select(prisonhelp, desor_core, d_incppl_pris_abc) %>%
  dplyr::filter(complete.cases(.))

desor_resid <- lm(desor_core ~ d_incppl_pris_abc, data = tmp)$residuals


# 2. Correlate those residuals with the outcome (prisonhelp)
cor(tmp$prisonhelp, desor_resid)


```

Partial/semi partial R2

```{r}
rsq::rsq.partial(m3_basic, type = "sp")
rsq::rsq.partial(m4_basic, type = "sp")
```

Adjusted R2

```{r}

base_m3 <- lm(prisonhelp ~ d_incppl_pris_abc + impact, data = raw_data_cleaned)
full <- update(base_m3, . ~ . + desor_core)
summary(full)$adj.r.squared - summary(base_m3)$adj.r.squared

base_m4 <- lm(prisonpen ~ d_incppl_pris_abc + impact, data = raw_data_cleaned)
full_m4 <- update(base_m4, . ~ . + desor_core)
summary(full_m4)$adj.r.squared - summary(base_m4)$adj.r.squared
```

**First Without Controls -- Help**

```{r, m3_0}


m3_0 <- lm(prisonhelp ~ impact)

hist(raw_data_cleaned$prisonhelp)

hist(raw_data_cleaned$prisonpen)

```

```{r, m3}

m3 <- lm(prisonhelp ~ impact + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,

    data = raw_data_cleaned
)

summary(m3)

```

### M4 Deservingness on Punitive Policy

**First Without Controls -- Punitive Policy** First, check how respondents who identify as Republican vs Democrat differ on average support for punitive policies (Republican and Democrat are both dummy variables, with Independent/Other as the reference group).

```{r}
prisonpen_by_party <- lm(prisonhelp ~ Republican + Democrat, data = raw_data_cleaned)
summary(prisonpen_by_party)
```

$$
\texttt{prisonpen}_{i} = \delta_0 + \delta_1 \cdot \texttt{impact}_{i} + \delta_2 \cdot \texttt{prisonerdeserves}_{i} + X^{\prime}_{i} \cdot \texttt{controlsvector} + \epsilon_{i}
$$

In each model, $delta_1$ captures the association between carceral contact and policy preferences, controlling for deservingness and covariates. $delta_2$ estimates the relationship between deservingness and policy support, which directly tests H2. A positive and statistically significant $delta_2$ in the help model—and a negative $delta_2$ in the punitive model—would support the hypothesis that warmer evaluations of incarcerated people correspond to greater support for decarceral policies.

```{r, m4}

m4 <- lm(prisonpen ~ impact + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology + penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,

    data = raw_data_cleaned
)


summary(m4)



```

Coefficients:

-   having one unit warmer deservingness perceptions of incarcerated people increases opposition to punitive prison policy, holding all else constant, by 0.005 points. Alternatively: a 10-point increase in deservingness corresponds to a 0.05 decrease in support. This is statistically significant (p\<0.001) but substantively small.

-   being impacted in some way *increases* *opposition to punitive policy* by 0.08 points, holding all else constant. This effect is significant at that level (0.029)

-   being republican instead of independent decreases opposition to punitive policy by 0.05. Being a democrat instead of independent decreases opposition by 0.04 points for democrats. These effects are not significant.

-   fiscal ideology - a unit increase in fiscal liberalness decreases opposition – increases support for – punitive prison policy by 0.06 and the effect is significant.

-   social ideology: a unit increase in social policy liberalness decreases opposition – increases support for - punitive prison policy, and the effect is significant.

-   penalpoint: each one unit increase (1-7 scale, sees the purpose of prison more about punishment) decreases opposition to (increases support for) punitive prison policies holding all else constant. This is significant (p\<0.001). This makes sense: If you think prison is for punishment, you're okay with the death penalty etc.

-   on desor_core: each one unit increase (0-100 scale, more general orientation to see help-needing groups as deserving) decreases opposition to punitive prison policy by 0.001 but this isn't significant.

-   3 of the FIRE (1-4) questions are statistically significant:

    -   not significant: a unit increase in *disagreement* that racial problems are rare corresponds with a 0.001 decrease in opposition to punitive policy. Ie: the more you agree that racial problems are rare, the more you support punitive policy. But this is not significant.

    -   a unit increase in *disagreement* that white people have advantages because of their race (deny white privilege) corresponds with a 0.05 unit *decrease* in opposition to punitive policy – those who agree that white privilege exists are more opposed to punitive policy (p = 0.007)

    -   a unit increase in disagreement that 'I am angry that racism exists' corresponds with a 0.05 increase in *opposition* to punitive policy.

        -   try this another way: if someone moves towards not being angry that racism exists, their opposition to punitive policy increases. if someone moves towards being angry that racism exist, their opposition to punitive policy goes down. this is surprising.

    -   a unit increase in disagreement with "I am fearful of people of other races" (ie, respondent is not fearful of other races) corresponds with 0.05 more support for punitive policy (significant).

Fit Statistics -- the model explains about 16% of variance in help policy support (R2 is 0.1678 adjusted R2 is 0.1593) after adjusting for the number of predictors.

The F-stat is highly significant.

```{r}
cor(raw_data_cleaned$fire_angry, raw_data_cleaned$prisonpen, use="pairwise.complete.obs")

```

### 4\_ by Incarc

```{r}
m3_inc <- lm(prisonhelp ~ incarc + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,

    data = raw_data_cleaned
)

m4_inc <- lm(prisonpen ~ incarc + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,data = raw_data_cleaned)

summary(m3_inc)
summary(m4_inc)
```

### 4\_ by Vict

```{r}
m3_vict <- lm(prisonhelp ~ vict + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,data = raw_data_cleaned
)

m4_vict <- lm(prisonpen ~ vict + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,data = raw_data_cleaned
)

summary(m3_vict)
summary(m4_vict)
```

### 4\_ by Knowincarc

```{r}

m3_prox <- lm(prisonhelp ~ knowincarc + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
    data = raw_data_cleaned
)

m4_prox <- lm(prisonpen ~ knowincarc + d_incppl_pris_abc +
    Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
    data = raw_data_cleaned
)

summary(m3_prox)
summary(m4_prox)

```

## 5 M5 & M6

To formally test whether perceptions of deservingness mediate the effect of carceral contact on policy preferences, I first estimate a set of interaction models to examine whether the relationship between deservingness and policy views differs depending on whether respondents have been directly or proximally impacted by the criminal legal system. This approach allows me to test whether contact moderates how deservingness evaluations translate into policy preferences—i.e., whether deservingness matters more (or less) for those with lived experience.

### M5: Interaction for Support of Carceral Policy Help

$$
\texttt{prisonhelp}_{i} = \theta_0 + \theta_1 \cdot \texttt{Deservingness}_{i} + \theta_2 \cdot \texttt{Contact}_{i} + \theta_3 (\texttt{Deservingness}_{i} \times \texttt{Contact}_{i}) + X^{\prime}_{i} \cdot \texttt{controlsvector} + \epsilon_{i}
$$

A significant interaction term (\$\\theta_3\$) would indicate that the effect of deservingness on policy support varies depending on whether the respondent has had contact with the criminal legal system. These models help determine whether deservingness operates similarly across groups—or if lived experience conditions how moral evaluations shape policy preferences.

```{r, m5}

m5a<- lm(prisonhelp ~ d_incppl_pris_abc * impact,
            data = raw_data_cleaned)
summary(m5a)

m5b <- lm(prisonhelp ~ d_incppl_pris_abc * impact,
            data = raw_data_cleaned)

m5 <- lm(prisonhelp ~ d_incppl_pris_abc * impact + Republican + Democrat + fiscal_ideology + social_ideology + penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace, 
            data = raw_data_cleaned)

summary(m5)

```

#### M5 Interpretation

The intercept is still n

The coefficient on the interaction term is -0.001

### M5_C : Interaction for Support of Carceral Policy Help with Mean-Centered Deservingness

Centering by subtracting deservingness's mean from each observation so the new mean is 0. This should simplify interpretation of coefficients in the interaction model: the main-effect coefficient for deservingness will represent the effect of deservingness for the average respondent who is not impacted rather than at a value of 0 in the original 0-100 scale.

```{r}

x_data <- raw_data_cleaned |>
  mutate(
    d_inc_c = d_incppl_pris_abc - mean(d_incppl_pris_abc, na.rm = TRUE),
    impact = as.integer(impact == 1)
  )

```

Rerunning M5 with Mean-Centered Deservingness

```{r}

m5_c<-lm(prisonhelp ~ d_inc_c*impact + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

summary(m5_c)

```

### M5_c Interpretation

-   *Main effect of deservingness: 0.005 (p\<0.001*) – For non-impacted respondents, each 1 point increase in deservingness on a 0-100 scale is associated with 0.005 more support for prison help policies, on a 1-5 scale. To put in a larger scale, this also means a 10 point increase in incarcerated people deservingness scores predicts 0.04 more support. However, because deservingness scores for incarcerated people are fairly clustered around the mean, this does not mean a ton. However, it is highly significant (p \<0.001).

-   *Main effect of impact (contact)* – Impacted respondents are 0.169 points more supportive of help oriented policy differ significantly in their baseline view of help policy from non-impacted people when deservingness scores for incarcerated people are held at their mean. This effect is significant (p \<0.001)

-   Main effect of the interaction – the slope of deservingness scores does not differ significantly between impacted and non impacted groups. Deservingness scores predicts help policy support about the same as they do for impacted and non-impacted respondents.

-   On controls:

    -   Penal point: a one unit change means a respondent sees the purpose of prison as more about punishment (7) than rehabilitation (1). A one unit change corresponds with a -0.04 decrease in support for helping policies, and it is significant.

    -   Ideology: the more conservative, the less supportive of help policy (significant).

    -   Desor_core: respondents who tend to view help needing groups as more deserving are somewhat more supportive of prison help policy. This is significant.

The model explains 36-37% of the variance.

Takaway: Deservingness has a positive effect on help-oriented carceral policies, and contact directly increases help-policy support.

### Post-Estimation Validation

```{r}

slopes_m5c <- slopes(m5_c, variables = "d_inc_c", by = "impact")
slopes_m5c

#predict values
pred_m5c <- predictions(m5_c, 
                        newdata = datagrid(d_inc_c = seq(min(x_data$d_inc_c, na.rm = TRUE),
                                                          max(x_data$d_inc_c, na.rm = TRUE),length = 100),
                          impact = c(0,1)
                        ))

print(pred_m5c)

# Semi-partial R² for each predictor
spr_m5<-rsq.partial(m5_c, adj = FALSE)   # help-policy model

```

Nov 2: these are now old but not hugely changed (signifcance is the big difference post re-run)

*Simple Slopes* – confirms that for both contact groups deservingness has a positive and significant relationship with help policy support. Among non-impacted respondents, each one point increase in deservingness predicts 0.00537. 0.004 (less predictive) for non impacted. Nearly identical and significant slopes confimrs the previous conclusion.

*Predicted Values* – The predicted mean support is 3.1 on a 1-5 scale regardless of contact type. Across the full range of deservingness scores, predicted lines for impacted and non impacted respondents are basically parallel. Basically confirms no interaction.

Both impacted and non-impacted respondents show a statistically identical positive relationship between perceived deservingness of incarcerated people and support for assistance-oriented policies. Each 10-point increase in deservingness corresponds to roughly a 0.04-point rise in policy support (on a 1–5 scale). Contact with the criminal legal system does not alter this association

*SPR2* - deservingness scores account uniquely for 3.6% of prisonhelp; contact adds 2.3% of unique variance,

### Model 6: Interaction for Support of Carceral Policy Punishment

$$
\texttt{prisonpen}_{i} = \theta_0 + \theta_1 \cdot \texttt{Deservingness}_{i} + \theta_2 \cdot \texttt{Contact}_{i} + \theta_3 (\texttt{Deservingness}_{i} \times \texttt{Contact}_{i}) + X^{\prime}_{i} \cdot \texttt{controlsvector} + \epsilon_{i}
$$

A significant interaction term (\$\\theta_3\$) would indicate that the effect of deservingness on policy support varies depending on whether the respondent has had contact with the criminal legal system. These models help determine whether deservingness operates similarly across groups—or if lived experience conditions how moral evaluations shape policy preferences.

```{r, m6}

m6a<- lm(prisonpen ~ d_incppl_pris_abc * impact,
            data = raw_data_cleaned)

summary(m6a)

m6b <- lm(prisonpen ~ d_incppl_pris_abc * impact,
            data = raw_data_cleaned)

m6 <- lm(prisonpen ~ d_incppl_pris_abc * impact + Republican + Democrat + fiscal_ideology + social_ideology + penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace, 
            data = raw_data_cleaned)

summary(m6)
```

### M6_C : Interaction for Support of Carceral Policy Punishment with Mean-Centered Deservingness

Centering by subtracting deservingness's mean from each observation so the new mean is 0. This should simplify interpretation of coefficients in the interaction model: the main-effect coefficient for deservingness will represent the effect of deservingness for the average respondent who is not impacted rather than at a value of 0 in the original 0-100 scale.

Rerunning M5 with Mean-Centered Deservingness

```{r}

m6c <- lm(prisonpen ~ d_inc_c*impact + Republican +
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)
    
summary(m6c)

```

M6c Interpretation

-   For non-impacted respondents, each 1 point increase in deservingness on a 0-100 scale is associated with 0.005 more opposition to punitive policies (LWOP and the death penalty), on a 1-5 scale. To put in a larger scale, this also means a 10 point increase in incarcerated people deservingness scores predicts 0.05 more opposition. However, because deservingness scores for incarcerated people are fairly clustered around the mean, this does not mean a ton. However, it is highly significant (p \<0.001). It is also not the relationship expected.

-   Impacted respondents are 0.076 points more opposed to punitive policy and this effect is significant (when deservingness scores held at mean).

-   The interaction (-0.00017, p = 0.89) says that the slope of deservingness scores does not differ significantly between impacted and non impacted groups. Deservingness scores predicts help policy support about the same as they do for impacted and non-impacted respondents.

-   Controls:

    -   Penal point: a one unit change means a respondent sees the purpose of prison as more about punishment (7) than rehabilitation (1). A one unit change corresponds with a very small but significant decrease in opposition to punitive policy (-0.046) and this effect is significant.

    -   Fire_privilege: a unit increase in disagreement with white privilege corresponds with a 0.055 unit decrease in opposition to punitive policy: respondents who discount white privilege are more supportive of punitive policy. This effect is significant.

    -   Fire_angry: a unit increase in disagreement with the statement "I am angry racism exists" (ie, not angry) corresponds with a 0.05 increase in opposition to punitive policy. Surprising but significant.

    -   Fire_fear: a unit increase in disagreement with being afraid of other races corresponds to a 0.05 decrease in opposition to punitive policy, and this effect is significant.

Takaway: Deservingness has a positive effect on help-oriented carceral policies, and this effect doesn't vary meaningfully between impacted and non impacted people.

### Post-Estimation Validation

```{r}

slopes_m6c <- slopes(m6c, variables = "d_inc_c", by = "impact")
slopes_m6c

#predicted
pred_m6c <- predictions(m6c, 
                        newdata = datagrid(d_inc_c = seq(min(x_data$d_inc_c, na.rm = TRUE),
                                                          max(x_data$d_inc_c, na.rm = TRUE),length = 100),
                          impact = c(0,1)
                        ))
pred_m6c

#semi-partial r2 comparisons
library(rsq)

# Semi-partial R² for each predictor
spr_m6<- rsq.partial(m6c, adj = FALSE)   # punitive-opposition model

```

*Simple slopes –* both contact groups rise in their opposition to punitive policy as deservingness increases, but impacted groups are 0.07 points higher. The lines seem parallel indicateing similar slopes, no interaction.

*Predicted values* show

SPR2 -

PUTTING SPR2 from both models in table:

```{r}

tibble(variable = spr_m5$variable, partial_r2 = round(spr_m5$partial.rsq, 3))
tibble(variable = spr_m6$variable, partial_r2 = round(spr_m6$partial.rsq, 3))
```

## 6 M7 & M8

These models let me test how much of the total effect of carceral contact on policy support is indirect via deservingness perceptions.

I decompose the effect of contact on policy attitudes into:

-   direct effect (ADE) = effect on policy holding deservingness constant

-   indirect effect (ACME) = effect of contact through deservingness

-   total effect (TE) = ADE +ACME

### Variable Prep/Check

-   mediator (M) = d_incppl_pris_abc (0-100)

-   treatment (T) is "impact" (0,1)

-   outcomes (Y): prisonhelp, prisonpen

-   controls (X) – vector

For each policy domain, will a mediator model and then an outcome model (have these already m1c and m3 m4).

Checks: don't want impact, d\_, prisonhelp and prisonpen to have missing values on the same rows. Checked and I should have 2011 observations going into

```{r}
summary(is.na(raw_data_cleaned$impact))
summary(is.na(raw_data_cleaned$d_incppl_pris_abc))
summary(is.na(raw_data_cleaned$prisonhelp))
summary(is.na(raw_data_cleaned$prisonpen))

sum(complete.cases(raw_data_cleaned[, c("impact", "d_incppl_pris_abc", "prisonhelp", "prisonpen","Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")]))

#this suggests I would drop about 30% of sample, down to 1577. Worried about the dropped respondents falling evenly ish on both sides of impact. 

#complete case flag
raw_data_cleaned$complete_case <-
  complete.cases(raw_data_cleaned[, c(
    "impact", "d_incppl_pris_abc", "prisonhelp", "prisonpen",
    "Republican", "Democrat", "fiscal_ideology", "social_ideology",
    "penalpoint", "desor_core", "fire_rare", "fire_privilege",
    "fire_angry", "fire_fear", "gender", "Black", "Hispanic", "OtherRace"
  )])

table(raw_data_cleaned$impact, raw_data_cleaned$complete_case)
prop.table(table(raw_data_cleaned$impact, raw_data_cleaned$complete_case), 1)
#chisq to test whether being a complete case is independent of treatment status, get yes/I can reject the null
chisq.test(table(raw_data_cleaned$impact, raw_data_cleaned$complete_case))

```

Complete-case analysis yielded 1,577 observations. A chi-square test indicated that missingness was not evenly distributed across impact status (p = .002), suggesting potential non-random attrition. Robustness checks with imputed data are warranted.

### M7

s

##### Model 7: Mediation Outcome Model - Support for Assistance Oriented Policy (Second Stage for Mediation Analysis)

$$
y_{i}^{\texttt{prisonhelp}} = \beta_0 + \beta_1 \cdot \texttt{impact}_{i} + \beta_2 \cdot \texttt{des\_or}_{i} + X^{\prime}_{i} \cdot \texttt{controlsvector} + u_{i}
$$

##### Model 8: Mediation Outcome Model - Support for Punishment Oriented Policy (Second Stage for Mediation Analysis)

$$
y_{i}^{\texttt{prisonpen}} = \beta_0 + \beta_1 \cdot \texttt{impact}_{i} + \beta_2 \cdot \texttt{des\_or}_{i} + X^{\prime}_{i} \cdot \texttt{controlsvector} + u_{i}
$$

where $y_{i}^{\texttt{prisonhelp}}$ is support for assistance-oriented or and $y_{i}^{\texttt{prisonpen}}$ is support for punitive policies. A statistically significant indirect effect would indicate that deservingness mediates part of the relationship between carceral contact and policy preferences.

```{r}

m7 <- mediate(m1c, m3, treat = "impact", mediator = "d_incppl_pris_abc",
              boot = TRUE, sims = 5000)

m8 <- mediate(m1c, m4, treat = "impact", mediator = "d_incppl_pris_abc",
              boot = TRUE, sims = 5000)

summary(m8)

m7_sens <- medsens(m7, rho.by = 0.1)
m8_sens <- medsens(m8, rho.by = 0.1)

summary(m7_sens)
summary(m8_sens)
```

The ACME (Average causal Mediation Effect) is the indirect effect of carceral contact on policy support through deservingness perceptions. For m7, it's 0.022 and is statistically significant and positive. That means respondents who are impacted show about 0.02 more support for help policy items on the 1-4 scale via higher deservingness perceptions. For m8, it's 0.0236 and significant: contact increases opposition to punitive policies via higher deservingness perceptions.

The ADE (Average Direct Effect) is the direct effect of contact on policy support, holding deservingness scores constant. For m7, it's 0.168 and is significant, so means that contact independent raises support for help oriented policies, even controlling for deservingness. For m8, it's 0.76 and is less significant but still statistically significant, suggesting there's a connection between direct contact and opposition to punitive policies beyond deservingness.

The total effect (combined direct and indirect) for m7 is 0.19 and is significant. For m8 it's 0.099 and significant.

The proportion mediation is the share of total effect explained by the mediator. For m7 it's 0.117. Roughly 12% of contact's effect on help-policy support operates through increased deservingness perceptions. For m8 it's 0.238 and significant. that means about 24% of the effect of impact on punitive policy views passes through deservingness. The CI here is a little wide though.

For m7: Contact with the carceral system significantly increases support for help-oriented policies. **About one-eighth of that total effect occurs *because* contact makes people see incarcerated individuals as more deserving, while the remaining \~88% is a direct shift in policy orientation not explained by deservingness.** For m8: Contact predicts less punitive attitudes, and nearly **a quarter of that effect** works indirectly through deservingness. The rest reflects a direct reduction in punitiveness not fully captured by changes in perceived deservingness.

Sensitivity analyses using the `medsens()` procedure indicate that the indirect effects are moderately robust to violations of sequential ignorability. For both help-oriented and punitive-policy outcomes, the estimated ACME would be reduced to zero only if the residual correlation between the mediator and outcome equations exceeded approximately ρ = 0.20, corresponding to an unobserved confounder jointly explaining about 4 % of residual variance in both models. This suggests the mediation findings are reasonably stable to modest unmeasured confounding.

(ie: these results are moderately robust to unmeasured confounding)

## 7 M10 – Variance

Goal: test whether deservingness perceptions also predict consistency of support across policy help items.

Need:

-   Regular predictors (use centered? d_inc_c) + impact

    -   controls

-   Individual help policy items, variance per respondent

    -   higher less consistent, lower more consistent

    -   should also probably record SD for interpretation, and mean(help) to diagnose mean-variance coupling

-   decide missing data rule – minimum number of answers. document exclusion count, probably chisquared.

-   distribution checks – expect skew.

    -   use raw variance, log(variance+error), or SD?

    -   choose 1 DV?

Estimation choices

-   model: OLS on variance (maybe on log variance) with HC robust SE's

-   weights (for now unweighted)

-   diagnostics

    -   check residual/skew heavy tails. if severe use log variance + e or SD as the DV

    -   inspect relation of mean(help) to variance. if strong, include mean as covariate

    -   influence (Cook's D), multicolinearity (VIF)

-   Interpretation

    -   negative beta -\> higher deservingness -\> lower variance -\> more consistent support

-   Reporting

    -   Main table: coefficients for DV = variance (or log-variance), robust SEs, adj. R².

    -   Brief text: magnitude for a **10-point deservingness change** and percent change in variance (if using log scale).

    -   Appendix:

        -   Alternative DV (SD or log-variance) + with/without mean(help).

        -   Weighted version.

        -   Plot of variance vs. mean(help) with LOWESS to justify the mean covariate.

            -   maybe not needed: entropy dispersion, reliability tie in (Cronbachs alpha, consistency analysis that complements reliability by focusing on individual level dispersion)

            -   heterogeneity: interact

#### Individual Help Policy Items, Variance, SD Prep

```{r}
help_policy_items[!help_policy_items %in% names(x_data)]

help_policy_items <- c("q25_2_rev", "q25_3_rev", "q25_4_rev", "q25_6_rev", "q23_2_rev", "q23_7_rev")

# Check distributions and means
summary(x_data[, c("q25_2_rev","q25_3_rev","q25_4_rev","q25_6_rev","q23_2_rev","q23_7_rev")])
cor(x_data$q23_2_rev, x_data$q23_7_rev, use="pairwise.complete.obs")

# checking if variance changes much when excluding q23s
x_data <- x_data %>%
  rowwise() %>%
  mutate(var_help_no_q23 = var(c_across(c("q25_2_rev","q25_3_rev","q25_4_rev","q25_6_rev")), na.rm = TRUE))
cor(x_data$variancehelp, x_data$var_help_no_q23, use="pairwise.complete.obs")

var_help_no_q23

# CONFIRM MISSINGNESS & SET MIN VALID ITEM RULE
x_data <- x_data %>%
  rowwise() %>%
  mutate(valid_help_items = sum(!is.na(c_across(all_of(help_policy_items))))) %>%
  ungroup()

table(x_data$valid_help_items)

#FOUND MISSINGNESS -- TESTING TO SEE DISTRIBUTION X TREATMENT
table(x_data$impact, x_data$valid_help_items < 4)
chisq.test(table(x_data$impact, x_data$valid_help_items < 4))

table(x_data$incarc, x_data$valid_help_items < 4)
chisq.test(table(x_data$incarc, x_data$valid_help_items < 4))

table(x_data$vict, x_data$valid_help_items < 4)
chisq.test(table(x_data$vict, x_data$valid_help_items < 4))

table(x_data$knowincarc, x_data$valid_help_items < 4)
chisq.test(table(x_data$knowincarc, x_data$valid_help_items < 4))

# DISTRIBUTION CHECKS
table(x_data$valid_help_items)

```

**Testing Missingness When Help Policy Excludes Election Items**

```{r}


```

Note:

-   My coding of the election related questions (jail voting, rights restoration) may artificially have inflated support for these issues.

    -   there's only moderate correlation (r \~ 0.43) between the two election items – they're internally consistent but still measure distinct domains.

-   The prison policy items (help) are low correlation (r\~0.3) between the overall variance measure and the 4 item prison only variance. Ie: including election items materially changes how variance behaves.

-   --\> the combined variance reflects cross-domain inconsistency

-   #option is to report both variance without election items and with election items (latter in analysis plan)

-   Missingness: Problems abound! (I Think?) (Maybe not? I get so confused by chi2 interp.

    -   Missing Counts

        -   1,690 respondents completed all answers, 345 completed four of the six

        -   suggests set the rule to 4 or more responses in order to be included -\> 2,035

    -   Chi squared:

        -   **The null hypothesis (H₀)**: Missingness (\<4 items completed) **IS independent** of treatment (impact)

        -   **The alternative hypothesis (H₁)**: Missingness **IS dependent** on treatment

        -   With p = 0.1033 \> 0.05, **fail to reject** the null hypothesis

        -   This means

            -   I do **not** have sufficient evidence that missingness is related to treatment

            -   The data are consistent with missingness being independent of (unrelated to) treatment

            -   This actually **supports** the safety of dropping incomplete responses, not the opposite

        -   BUT marginal significance is not far from 0.05. combined with counts, potential problem still.

        -   x Impact – most missing for know incarc

        -   SO:

            -   test additional patterns (loop this back up)

            -   sensitivity analysis

            -   IMPUTATION

***This prompts me to check missingness for each combination of help items***

```{r}
# binary missing indicator where 1 is missing 0 is answered
missing_indicators <- x_data[help_policy_items]
missing_indicators <- is.na(missing_indicators)*1

# make string pattern for pattern of missing questions - ie: 000011 means just election ones missing
x_data$missing_pattern <- apply(missing_indicators, 1, function(x){paste0(x, collapse = "")})

#count questions answered per respondent
x_data$n_answered <- 6 - rowSums(missing_indicators)

total_patterns <- x_data %>%
  group_by(missing_pattern, n_answered) %>%
  summarise(
    n = n(),
    pct = n()/nrow(x_data) * 100
  ) %>%
  arrange(desc(n))

print(total_patterns)

patterns_by_impact <- x_data %>%
  group_by(impact, missing_pattern, n_answered) %>%
  summarise(
    n = n()
  ) %>%
  group_by(impact) %>%
  mutate(
    pct_within_group = n/sum(n) * 100
  ) %>%
  arrange(impact, desc(n))

print(patterns_by_impact)

patterns_by_incarc <- x_data %>%
  group_by(incarc, missing_pattern, n_answered) %>%
  summarise(
    n = n()
  ) %>%
  group_by(incarc) %>%
  mutate(
    pct_within_group = n/sum(n) * 100
  ) %>%
  arrange(incarc, desc(n))

print(patterns_by_incarc)

patterns_by_vict <- x_data %>%
  group_by(vict, missing_pattern, n_answered) %>%
  summarise(
    n = n()
  ) %>%
  group_by(vict) %>%
  mutate(
    pct_within_group = n/sum(n) * 100
  ) %>%
  arrange(vict, desc(n))

print(patterns_by_vict)

patterns_by_knowincarc <- x_data %>%
  group_by(knowincarc, missing_pattern, n_answered) %>%
  summarise(
    n = n()
  ) %>%
  group_by(knowincarc) %>%
  mutate(
    pct_within_group = n/sum(n) * 100
  ) %>%
  arrange(knowincarc, desc(n))

print(patterns_by_knowincarc)
```

#### Variance Test

```{r}
# OK picking up here with excluding respondents with less than 4 items answered (mostly people who didn't hang on until the elections questions in the survey)

x_data <- x_data %>% filter(valid_help_items>=4)

```

Distribution checks

```{r}

hist(x_data$variancehelp, breaks = 30)
hist(log(x_data$variancehelp + .001), breaks = 30)
```

--\> won't use the log as my DV

Compare mean & SD

```{r}
x_data <- x_data %>%
  rowwise() %>%
  mutate(meanhelp = mean(c_across(all_of(help_policy_items)), na.rm = TRUE)) %>%
  ungroup()

cor(x_data$meanhelp, x_data$variancehelp, use = "pairwise.complete.obs")

```

This shows a mild mean-variance correlation. It's kind of right on the cusp in absolute terms – the concern threshold is usually \|0.3-0.4\|. However, it's also conceptually logical that respondents with higher average support might systematically have less variance – that's kind of the thing I'm interested in. Don't need to use meanhelp as a control (but added potential check on this later).

Next Diagnostic: Checking different distributions to figure out what to use

```{r}

x_data$variancehelp_log <- log(x_data$variancehelp + 0.001)
x_data$sdhelp <- sqrt(x_data$variancehelp)

summary(x_data$variancehelp)
summary(x_data$variancehelp_log)
summary(x_data$sdhelp)

hist(x_data$variancehelp, breaks = 30, main = "Variance of Help Items")
hist(x_data$variancehelp_log, breaks = 30, main = "Log Variance of Help Items")
hist(x_data$sdhelp, breaks = 30, main = "Standard Deviation of Help Items")

library(e1071)
skewness(raw_data_cleaned$variancehelp, na.rm = TRUE)
skewness(raw_data_cleaned$variancehelp_log, na.rm = TRUE)
skewness(raw_data_cleaned$sdhelp, na.rm = TRUE)
```

### OLS with variancehelp as DV (also running log and SD)

```{r}
#using centered deservingness 
m10 <- lm(variancehelp ~ d_inc_c + impact + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

m10_vlog <- lm(variancehelp_log ~ d_inc_c + impact + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

m10_sd <- lm(sdhelp ~ d_inc_c + impact + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

coeftest(m10, vcov = vcovHC(m10, type = "HC1"))
coeftest(m10_vlog, vcov = vcovHC(m10, type = "HC1"))
coeftest(m10_sd, vcov = vcovHC(m10, type = "HC1"))
```

FOR LATER - Sensitivity check to find out or show results aren't (tbd) sensitive to mean-variance coupling. If coefficients on `d_inc_c` and `impact` are similar across models, can say that results are robust to controlling for average support across policy items; the mild mean-variance correlation (-0.215) does not meaningfully alter the main findings.

```{r}
# Model 1: main specification
m10_log <- lm(variancehelp_log ~ d_inc_c + impact + controls..., data = x_data)

# Model 2: robustness check including meanhelp
m10_mean <- lm(variancehelp_log ~ d_inc_c + impact + meanhelp + controls..., data = x_data)

# Compare side by side
library(stargazer)
stargazer(m10_log, m10_mean, type = "text",
          title = "Robustness Check: Controlling for Average Support (meanhelp)",
          dep.var.labels = "Log Variance of Help Policy Responses",
          covariate.labels = c("Deservingness (centered)", "Impact", "Mean Help Support", "Controls"),
          omit.stat = c("f", "ser"),
          notes = "Models estimated with HC1 robust standard errors.")

```

# Robustness Checks

## rc_1

-   whether the effect of carceral contact on deservingness varies across ideological groups

-   addresses concerns that the relationship between contact and deservingness may simply reflect underlying political ideology

-   prior work suggests that while ideology is a powerful predictor of attitudes toward marginalized groups, it may also obscure important conditional variation in how individuals interpret personal or vicarious experiences with the criminal legal system

-   Thus, I test the possibility that respondents with different ideological orientations may interpret contact differently

$$
\texttt{prisonerdeserves}_{i} = \beta_0 + \beta_1 \cdot \texttt{impact}_{i} + \beta_2 \cdot \texttt{gender}_{i} + \beta_3 \cdot \texttt{race}_{i} + \beta_4 \cdot \texttt{education}_{i} + \beta_5 \cdot \texttt{urban}_{i} + \beta_6 \cdot \texttt{party}_{i} + \beta_7 \cdot \texttt{ideology}_{i} + \beta_8 \cdot \texttt{racialresentment}_{i} + \beta_9 \cdot \texttt{desor}_{i} + \beta_{10} \cdot \texttt{policydisposition}_{i} + \beta_{11} \cdot (\texttt{impact}_{i} \times \texttt{ideology}_{i}) + \beta_{12} \cdot (\texttt{impact}_{i} \times \texttt{race}_{i}) + u_{i}
$$

Vars to construct or check:

-   policy disposition: support for medicaid (q20), unemployment assistance (q19), views on mimum wage and government support for the poor, and agreement with the importance of helping refugees.

Medicaid, Unemployment Questions -- here, I find and look into odd coding of responses based on survey pdf export that suggests a coding scheme that needs the following recode: 1 = much more assistance 2 = more assistance 3 = the right amount then 4 = much less assistance 5 = don't know 6 = less assistance to 1 = much more assistance 2 = more assistance 3 = the right amount then 4 --\> 5 = much less assistance 5 --\> drop = don't know 6 --\> 4= less assistance

ie. it is a 1-5 scale with 5 being least assistance, but the original coding has 4 and 6 flipped and 5 as don't know.

```{r}

# policy - medicaid and unemployment original coding: much more assistance (1), more assistance (2), about the right about (3), less assistance (6), much less assistnatce (4), don't know (5)

summary(x_data$q20)
summary(x_data$q19)

hist(x_data$q20)
hist(x_data$q19)

table(x_data$q20)
table(x_data$q19)

# looking at relationship with fiscal ideology which is coded 0 very conservative to 5 very liberal
cor(x_data$q19, x_data$fiscal_ideology, use = "pairwise.complete.obs")
cor(x_data$q20, x_data$fiscal_ideology, use = "pairwise.complete.obs")

# checking that counts match expected by party
table(x_data$q19, x_data$Republican)
table(x_data$q19, x_data$Democrat)

table(x_data$q20, x_data$Republican)
table(x_data$q20, x_data$Democrat)

#recode
x_data <- x_data %>%
  mutate(
    q19_recoded = case_when(
      q19 == 1 ~ 1, 
      q19 == 2 ~ 2,
      q19 == 3 ~ 3,
      q19 == 4 ~ 5,
      q19 == 5 ~ NA_real_,
      q19 == 6 ~ 4 
    ),
    q20_recoded = case_when(
      q20 == 1 ~ 1,
      q20 == 2 ~ 2,
      q20 == 3 ~ 3,
      q20 == 4 ~ 5,
      q20 == 5 ~ NA_real_,
      q20 == 6 ~ 4
    )
  )

```

Next policy question (q74_3) is how important do you think it is for the US to "Taking in civilian refugees trying to escape violence and war." Raw coding: not very important (1), not important (2), important (3), very important (4), don't know (5). Here, I'm going to recode 5 to be the middle value so this is also on a 1-5 scale: 1-\>1 2-\>2 3-\>4 4-\>5 5-\>3

```{r}
x_data <- x_data %>%
  mutate(
    q74_3_recoded = case_when(
      q74_3 == 1 ~ 1,
      q74_3 == 2 ~ 2,
      q74_3 == 3 ~ 4,
      q74_3 == 4 ~ 5,
      q74_3 == 5 ~ 3
    )
  )

```

Next, I am going to flip the scale so that it matches the direction of q19 and q20, before averaging respondent answers to these questions to create a composite.

```{r}

x_data <- x_data %>%
  mutate(
    q74_3_recoded_flipped = 6 - q74_3_recoded
  ) %>%
  rowwise() %>%
  mutate(
    policydisposition = mean(c_across(c("q19_recoded", "q20_recoded", "q74_3_recoded_flipped")), na.rm = TRUE)
  ) %>%
  ungroup()

```

Thus, the scale for policydisposition is: 1 = much more assistance + taking in more refugees very important = most liberal 2 = more assistance 3 = the right amount 4 = less assistance 5 = much less assistance + taking in refugees unimportant = most conservative

I explore whether the effect of carceral contact on deservingness varies across ideological groups. This analysis addresses concerns that the relationship between contact and deservingness may simply reflect underlying political ideology. More broadly, prior work suggests that while ideology is a powerful predictor of attitudes toward marginalized groups, it may also obscure important conditional variation in how individuals interpret personal or vicarious experiences with the criminal legal system. Thus, I test the possibility that respondents with different ideological orientations may interpret contact differently.

I model criminal legal contact’s effect on other forms of policy help by regressing aggregated attitudes towards those policies on impact. y_i\^"polorientation" =β_0+β_1⋅〖"impact" 〗\_i+β_2⋅〖"desor" 〗\_i+X_i'⋅"controlsvector"+u_i

```{r}

rc_1 <- lm(policydisposition ~ impact + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

rc_1_inc <- lm(policydisposition ~ incarc + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

rc_1_vict <- lm(policydisposition ~ vict + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + 
    gender + Black + Hispanic + OtherRace, data = x_data)

rc_1_knowincarc <- lm(policydisposition ~ knowincarc + Republican + 
    Democrat + fiscal_ideology + social_ideology + penalpoint + 
    desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace, data = x_data)

summary(rc_1)
summary(rc_1_inc)
summary(rc_1_vict)
summary(rc_1_knowincarc)
```

The results indicate that carceral contact significantly predicts a more conservative policy disposition (β₁ = -0.14 , p \< 0.01), even after controlling for political affiliation, ideology, and other relevant covariates. This suggests that individuals with personal or vicarious experience with the criminal legal system tend to favor less assistance-oriented policies overall.

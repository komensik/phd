table(raw_data_cleaned$vict)
table(raw_data_cleaned$q4_2_1)
gracious_recode <- tibble::tibble(
contact_pattern = c(
"100000", "100001", "101001", "101000", #Incarcerated Only
"010000", "010001", "011001", "011000",  # Knows Inc Only
"001100", "001101", "000100", "000101",  # Victim Only
"110000", "110001", "111001", "111000", # Inc, Knows Inc
"010100", "010101", "011101", "011100",
"110100", "110101", "111101", # Inc, Knows Inc, Vict
"010110", "011111", "011110", "010111",  # Knows Inc, Vict, Knows Vict
"110110",  "111110", "110111", "111111",  # All
),
label = c(
"Incarcerated Only",
"Knows Inc Only",
"Victim Only",
"Inc, Knows Inc",
"Knows Inc, Vict",
"Inc, Knows Inc, Vict",
"Knows Inc, Vict, Knows Vict",
"Also Vict",
"Also and only Vict",
"Victim Only",
"Also and only KI"
)
)
gracious_recode <- tibble::tibble(
contact_pattern = c(
"100000", "100001", "101001", "101000", #Incarcerated Only
"010000", "010001", "011001", "011000",  # Knows Inc Only
"001100", "001101", "000100", "000101",  # Victim Only
"110000", "110001", "111001", "111000", # Inc, Knows Inc
"010100", "010101", "011101", "011100",
"110100", "110101", "111101", # Inc, Knows Inc, Vict
"010110", "011111", "011110", "010111",  # Knows Inc, Vict, Knows Vict
"110110",  "111110", "110111", "111111",  # All
),
label = c(
"Incarcerated Only",
"Knows Inc Only",
"Victim Only",
"Inc, Knows Inc",
"Knows Inc, Vict",
"Inc, Knows Inc, Vict",
"Knows Inc, Vict, Knows Vict",
"Also Vict",
"Also and only Vict",
"Victim Only",
"Also and only KI"
)
)
gracious_recode <- tibble::tibble(
contact_pattern = c(
"100000", "100001", "101001", "101000", #Incarcerated Only
"010000", "010001", "011001", "011000",  # Knows Inc Only
"001100", "001101", "000100", "000101",  # Victim Only
"110000", "110001", "111001", "111000", # Inc, Knows Inc
"010100", "010101", "011101", "011100",
"110100", "110101", "111101", # Inc, Knows Inc, Vict
"010110", "011111", "011110", "010111",  # Knows Inc, Vict, Knows Vict
"110110",  "111110", "110111", "111111",  # All
),
label = c(
"Incarcerated Only",
"Knows Inc Only",
"Victim Only",
"Inc, Knows Inc",
"Knows Inc, Vict",
"Inc, Knows Inc, Vict",
"Knows Inc, Vict, Knows Vict",
"Also Vict",
"Also and only Vict",
"Victim Only",
"Also and only KI"
)
)
# Step 1: Create the pattern-to-label lookup
pattern_lookup <- tibble::tibble(
contact_pattern = c(
"100000", "100001", "101001", "101000",
"010000", "010001", "011001", "011000",
"001100", "001101", "000100", "000101",
"110000", "110001", "111001", "111000",
"100100", "100101", "101100", "101101",
"100010", "101011", "100011", "101010",
"010100", "010101", "011101", "011100",
"110100", "110101", "111101",
"010110", "011111", "011110", "010111",
"110110", "111110", "110111", "111111"
),
label = c(
rep("Incarcerated Only", 4),
rep("Knows Incarcerated Only", 4),
rep("Victim Only", 4),
rep("Inc & Knows Inc", 4),
rep("Inc & Vict", 4),
rep("Inc & Knows Vict", 4),
rep("Knows Inc & Vict", 4),
rep("Inc, Knows Inc, Vict", 3),
rep("Knows Inc, Vict, Knows Vict", 4),
rep("All", 4)
)
)
# Step 2: Join this to dataset and count
pattern_counts <- raw_data_cleaned %>%
inner_join(pattern_lookup, by = "contact_pattern") %>%
count(label, contact_pattern, name = "count") %>%
arrange(label, desc(count))
# View the result
print(pattern_counts)
# Calculate basic totals
table_a <- tibble::tibble(
Type = c("Been Incarcerated", "Knows Incarcerated", "Been Victimized"),
Count = c(total_incarcerated, total_knows_incarcerated, total_victim),
Percent_of_Sample = round(100 * Count / nrow(raw_data_cleaned), 1)
)
table_a %>%
gt() %>%
cols_label(
Type = "Type",
Count = "Total Count",
Percent_of_Sample = "Percent of Sample"
) %>%
tab_header(title = "Appendix Table A. Basic Contact Types") %>%
tab_options(table.font.size = "small")
controls_vict <- c("vict", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_vict <- data.frame()
for (v_vict in controls_vict) {
f_vict <- as.formula(paste("d_incppl_pris_abc ~", v_vict))
fm_vict <- lm(f_vict, data = raw_data_cleaned)
results_vict <- rbind(results_vict,
data.frame(var = v_vict,
adjR2 = summary(fm_vict)$adj.r.squared,
AIC = AIC(fm_vict)))
}
results <- results[order(-results_vict$adjR2), ]
print(results_vict)
#NEXT -- testing when adding controls in to m1 sequentially
for(v_v in controls[-1])
{
f_v <- as.formula(paste("d_incppl_pris_abc ~ vict +", v_v))
fm_v <- lm(f_v, data = raw_data_cleaned)
cat(v_v, "adjR2 =", summary(fm_v)$adj.r.squared-summary(mv)$adj.r.squared, "\n")
}
#semi-partial R2 for each model predictor (how much unique variance each predictor explains in the full model, controlling for all other variables)
sp_r2_v <- rsq.partial(mv, type = "sp")
sp_r2_v
#in table
sp_table_v <- data.frame(
variable_v = sp_r2_v$variable,
semi_partial_R2_v = sp_r2_v$partial.rsq
)
# largest to smallest
sp_table_v <- sp_table_v %>%
arrange(desc(semi_partial_R2_v))
# round for display
sp_table_v$semi_partial_R2_v <- round(sp_table_v$semi_partial_R2_v, 4)
print(sp_table_v)
mvs <- lm(d_incppl_pris_abc ~ vict + Republican + Democrat + fiscal_ideology +
social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned)
# 1. Standardized coefficients
library(broom)
y_sd_v <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)
# compute sd for each predictor (binary and continuous)
sds_v <- sapply(model.frame(mvs)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs_v <- coef(mvs)
# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs_v <- coefs_v * c(1, sds_v / y_sd_v)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(mvs) |>
mutate(std_est_v = estimate * c(0, sds_v / y_sd_v))
summary(mv)
coeftest(mv, vcov = vcovHC(mv, type = "HC1"))
print(results_vict)
print(sp_table_v)
#10-31 AGAIN checking that I know what I'm talking about re: counts -- YES VICT, 277
mv <- lm(d_incppl_pris_abc ~ vict +
Republican + Democrat +
fiscal_ideology + social_ideology +
penalpoint + desor_core +
fire_rare + fire_privilege + fire_angry + fire_fear +
gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned
)
summary(mv)
coeftest(mv, vcov = vcovHC(mv, type = "HC1"))
controls_vict <- c("vict", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_vict <- data.frame()
results_vict <- results[order(-results_vict$adjR2), ]
results_vict <- data.frame()
for (v_vict in controls_vict) {
f_vict <- as.formula(paste("d_incppl_pris_abc ~", v_vict))
fm_vict <- lm(f_vict, data = raw_data_cleaned)
results_vict <- rbind(results_vict,
data.frame(var = v_vict,
adjR2 = summary(fm_vict)$adj.r.squared,
AIC = AIC(fm_vict)))
}
results_vict <- results[order(-results_vict$adjR2), ]
print(results_vict)
results_vict <- data.frame()
for (v_vict in controls_vict) {
f_vict <- as.formula(paste("d_incppl_pris_abc ~", v_vict))
fm_vict <- lm(f_vict, data = raw_data_cleaned)
results_vict <- rbind(results_vict,
data.frame(var = v_vict,
adjR2 = summary(fm_vict)$adj.r.squared,
AIC = AIC(fm_vict)))
}
results_vict <- results[order(-results_vict$adjR2), ]
print(results_vict)
results_vict <- data.frame()
results_vict <- results[order(-results_vict$adjR2), ]
#first make no control model version
minc_base <- lm(d_incppl_pris_abc ~ incarc, data = raw_data_cleaned)
controls_inc <- c("incarc", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
for(v_inc in controls_inc[-1])
{
f_inc <- as.formula(paste("d_incppl_pris_abc ~ incarc +", v_inc))
fm_inc <- lm(f_inc, data = raw_data_cleaned)
cat(v_inc, "adjR2 =", summary(fm_inc)$adj.r.squared-summary(minc_base)$adj.r.squared, "\n")
}
#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mv_base <- lm(d_inc_ppl_pris_abc ~ vict, data=raw_data_cleaned)
#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mv_base <- lm(d_incppl_pris_abc ~ vict, data=raw_data_cleaned)
#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mv_base <- lm(d_incppl_pris_abc ~ vict, data=raw_data_cleaned)
for(v_v in controls_vict[-1])
{
f_v <- as.formula(paste("d_incppl_pris_abc ~ vict +", v_v))
fm_v <- lm(f_v, data = raw_data_cleaned)
cat(v_v, "adjR2 =", summary(fm_v)$adj.r.squared-summary(mv_base)$adj.r.squared, "\n")
}
mvs <- lm(d_incppl_pris_abc ~ vict + Republican + Democrat + fiscal_ideology +
social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned)
y_sd_v <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)
# compute sd for each predictor (binary and continuous)
sds_v <- sapply(model.frame(mvs)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs_v <- coef(mvs)
# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs_v <- coefs_v * c(0, sds_v / y_sd_v)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(mvs) |>
mutate(std_est_v = estimate * c(0, sds_v / y_sd_v))
mki <- lm(d_incppl_pris_abc ~ knowincarc +
Republican + Democrat +
fiscal_ideology + social_ideology +
penalpoint + desor_core +
fire_rare + fire_privilege + fire_angry + fire_fear +
gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned
)
coeftest(mki, vcov = vcovHC(mki, type = "HC1"))
controls_prox <- c("vict", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_prox <- data.frame()
for (v_prox in controls_prox) {
f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
results_prox <- rbind(results_prox,
data.frame(var = v_prox,
adjR2 = summary(fm_prox)$adj.r.squared,
AIC = AIC(fm_prox)))
}
results_prox <- results[order(-results_prox$adjR2), ]
print(results_prox)
#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mki_base <- lm(d_incppl_pris_abc ~ knowincarc, data=raw_data_cleaned)
for(v_prox in controls_prox[-1])
{
f_prox <- as.formula(paste("d_incppl_pris_abc ~ knowinc +", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
cat(v_prox, "adjR2 =", summary(fm_prox)$adj.r.squared-summary(mki_base)$adj.r.squared, "\n")
}
controls_prox <- c("knowinc", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_prox <- data.frame()
for (v_prox in controls_prox) {
f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
results_prox <- rbind(results_prox,
data.frame(var = v_prox,
adjR2 = summary(fm_prox)$adj.r.squared,
AIC = AIC(fm_prox)))
}
controls_prox <- c("knowinc","Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_prox <- data.frame()
for (v_prox in controls_prox) {
f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
results_prox <- rbind(results_prox,
data.frame(var = v_prox,
adjR2 = summary(fm_prox)$adj.r.squared,
AIC = AIC(fm_prox)))
}
controls_prox <- c("knowincarc","Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_prox <- data.frame()
for (v_prox in controls_prox) {
f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
results_prox <- rbind(results_prox,
data.frame(var = v_prox,
adjR2 = summary(fm_prox)$adj.r.squared,
AIC = AIC(fm_prox)))
}
results_prox <- results[order(-results_prox$adjR2), ]
print(results_prox)
results_prox <- data.frame()
for (v_prox in controls_prox) {
f_prox <- as.formula(paste("d_incppl_pris_abc ~", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
results_prox <- rbind(results_prox,
data.frame(var = v_prox,
adjR2 = summary(fm_prox)$adj.r.squared,
AIC = AIC(fm_prox)))
}
results_prox <- results[order(-results_prox$adjR2), ]
print(results_prox)
#NEXT -- testing when adding controls in to m1 sequentially--needs fix
#first make base
mki_base <- lm(d_incppl_pris_abc ~ knowincarc, data=raw_data_cleaned)
for(v_prox in controls_prox[-1])
{
f_prox <- as.formula(paste("d_incppl_pris_abc ~ knowincarc +", v_prox))
fm_prox <- lm(f_prox, data = raw_data_cleaned)
cat(v_prox, "adjR2 =", summary(fm_prox)$adj.r.squared-summary(mki_base)$adj.r.squared, "\n")
}
sp_r2_prox <- rsq.partial(mki, type = "sp")
sp_r2_prox
#in table
sp_table_prox <- data.frame(
variable_prox = sp_r2_prox$variable,
semi_partial_R2_prox = sp_r2_prox$partial.rsq
)
# largest to smallest
sp_table_prox <- sp_table_prox %>%
arrange(desc(semi_partial_R2_prox))
# round for display
sp_table_prox$semi_partial_R2_prox <- round(sp_table_prox$semi_partial_R2_prox, 4)
print(sp_table_prox)
mkis <- lm(d_incppl_pris_abc ~ knowincarc + Republican + Democrat + fiscal_ideology +
social_ideology + penalpoint + desor_core + fire_rare + fire_privilege +
fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned)
# 1. Standardized coefficients
library(broom)
y_sd_prox <- sd(raw_data_cleaned$d_incppl_pris_abc, na.rm = TRUE)
# compute sd for each predictor (binary and continuous)
sds_prox <- sapply(model.frame(mkis)[-1], function(x) sd(x, na.rm=TRUE))  # excludes response
coefs_prox <- coef(mkis)
# standardized coef = b * sd(x) / sd(y).  For factor dummies sd(x) is the std dev of 0/1 vector.
std_coefs_prox <- coefs_prox * c(0, sds_prox / y_sd_prox)   # note: first coef is intercept so alignment matters
# better to use broom::tidy:
tidy(mkis) |>
mutate(std_est_prox = estimate * c(0, sds_prox / y_sd_prox))
names(raw_data_cleaned)
knitr::opts_chunk$set(
echo = FALSE,       # Hide code by default
warning = FALSE,
message = FALSE
)
# Load packages
library(dplyr)
library(tidyr)
library(readr)
library(janitor)   # for clean_names()
library(tibble)
library(stringr)
library(haven)
library(tibble)
library(gt)
library(marginaleffects)
library(mediation)
library(naniar)
library(rsq)
#check counts:
#raw_data_cleaned %>% count(d_incwomen_abc)
#summary:
#summary(raw_data_cleaned$d_incwomen_abc)
#histogram
hist(raw_data_cleaned$d_incwomen_abc, breaks = 20,
main = "Deservingness of Incarcerated People/Prisoners",
xlab = "Deservingness (0–100)", col = "gray80", border = "white")
#mean(raw_data_cleaned$d_incwomen_abc, na.rm = TRUE)
#sd(raw_data_cleaned$d_incwomen_abc, na.rm = TRUE)
#var(raw_data_cleaned$d_incwomen_abc, na.rm = TRUE)
boxplot(raw_data_cleaned$d_incwomen_abc)
# Histogram for generalized deservingness control variable
hist(raw_data_cleaned$desor_core, breaks = 20,
main = "Generalized Deservingness",
xlab = "Average Deservingness of Help-Target Groups (0–100)",
col = "gray80", border = "white")
summary(raw_data_cleaned$desor_core)
sd(raw_data_cleaned$desor_core, na.rm = TRUE)
m1 <- lm(d_incwomen_abc ~ impact, data = raw_data_cleaned)
summary(m1)
library(ggplot2)
# Summarize means and confidence intervals
plot_data <- raw_data_cleaned %>%
filter(!is.na(impact)) %>%  # <- filter out NA values
group_by(impact) %>%
summarize(
mean_deserving = mean(d_incwomen_abc, na.rm = TRUE),
se = sd(d_incwomen_abc, na.rm = TRUE) / sqrt(n()),
.groups = "drop"
) %>%
mutate(
impact_label = ifelse(impact == 1, "Any Contact", "No Contact"),
ci_lower = mean_deserving - 1.96 * se,
ci_upper = mean_deserving + 1.96 * se
)
# Plot
ggplot(plot_data, aes(x = impact_label, y = mean_deserving)) +
geom_col(fill = "gray60") +
geom_errorbar(aes(ymin = ci_lower, ymax = ci_upper), width = 0.2) +
labs(
x = NULL,
y = "Mean Deservingness Rating (0–100)",
title = "Deservingness of Incarcerated People by Contact Experience"
) +
theme_minimal(base_size = 14)
m2 <- lm(d_incwomen_abc ~ impact +
Republican + Democrat +
fiscal_ideology + social_ideology +
penalpoint + desor_core +
fire_rare + fire_privilege + fire_angry + fire_fear +
gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned
)
summary(m2)
controls <- c("impact", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
for (v in controls) {
f <- as.formula(paste("d_incwomen_abc ~", v))
fm <- lm(f, data = raw_data_cleaned)
results <- rbind(results,
data.frame(var = v,
adjR2 = summary(fm)$adj.r.squared,
AIC = AIC(fm)))
}
results <- results[order(-results$adjR2), ]
print(results)
#NEXT -- testing when adding controls in to m1 sequentially
for(v in controls[-1])
{
f <- as.formula(paste("d_incwomen_abc ~ impact +", v))
fm <- lm(f, data = raw_data_cleaned)
cat(v, "adjR2 =", summary(fm)$adj.r.squared-summary(m1)$adj.r.squared, "\n")
}
minc <- lm(d_incwomen_abc ~ incarc +
Republican + Democrat +
fiscal_ideology + social_ideology +
penalpoint + desor_core +
fire_rare + fire_privilege + fire_angry + fire_fear +
gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned
)
summary(minc)
controls_inc <- c("incarc", "Republican","Democrat","fiscal_ideology","social_ideology","penalpoint","desor_core","fire_rare", "fire_privilege","fire_angry","fire_fear","gender","Black","Hispanic","OtherRace")
results_inc <- data.frame() #to reset
for (v_inc in controls_inc) {
f_inc <- as.formula(paste("d_incwomen_abc ~", v_inc))
fm_inc <- lm(f_inc, data = raw_data_cleaned)
results_inc <- rbind(results_inc,
data.frame(var = v_inc,
adjR2 = summary(fm_inc)$adj.r.squared,
AIC = AIC(fm_inc)))
}
results_inc <- results[order(-results_inc$adjR2), ]
print(results_inc)
#NEXT -- testing when adding controls in to minc sequentially
#first make no control model version
minc_base <- lm(d_incwomen_abc ~ incarc, data = raw_data_cleaned)
for(v_inc in controls_inc[-1])
{
f_inc <- as.formula(paste("d_incwomen_abc ~ incarc +", v_inc))
fm_inc <- lm(f_inc, data = raw_data_cleaned)
cat(v_inc, "adjR2 =", summary(fm_inc)$adj.r.squared-summary(minc_base)$adj.r.squared, "\n")
}
#semi-partial R2 for each model predictor (how much unique variance each predictor explains in the full model, controlling for all other variables)
sp_r2 <- rsq.partial(minc, type = "sp")
sp_r2
#in table
sp_table <- data.frame(
variable = sp_r2$variable,
semi_partial_R2 = sp_r2$partial.rsq
)
# largest to smallest
sp_table <- sp_table %>%
arrange(desc(semi_partial_R2))
# round for display
sp_table$semi_partial_R2 <- round(sp_table$semi_partial_R2, 4)
print(sp_table)
mki <- lm(d_incwomen_abc ~ knowincarc +
Republican + Democrat +
fiscal_ideology + social_ideology +
penalpoint + desor_core +
fire_rare + fire_privilege + fire_angry + fire_fear +
gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned
)
summary(mki)
m5 <- lm(prisonhelp ~ d_incppl_pris_abc * impact + Republican + Democrat + fiscal_ideology + social_ideology +penalpoint + desor_core + fire_rare + fire_privilege + fire_angry + fire_fear + gender + Black + Hispanic + OtherRace,
data = raw_data_cleaned)
summary(m5)
